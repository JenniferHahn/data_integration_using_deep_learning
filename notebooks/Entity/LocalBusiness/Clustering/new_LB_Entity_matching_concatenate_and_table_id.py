{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "90c6e08b",
   "metadata": {
    "pycharm": {
     "is_executing": True
    }
   },
   "outputs": [],
   "source": [
    "#!pip install rank-bm25\n",
    "#from rank_bm25 import BM25Okapi\n",
    "import pandas as pd\n",
    "#import matplotlib.pyplot as plt\n",
    "#import seaborn as sns\n",
    "import os\n",
    "from os import listdir\n",
    "from os.path import isfile, join\n",
    "import re\n",
    "import numpy as np\n",
    "from math import floor, ceil\n",
    "\n",
    "import json\n",
    "import gzip\n",
    "\n",
    "from os import walk\n",
    "from scipy.spatial import KDTree\n",
    "\n",
    "# !pip install geopy\n",
    "# !pip install phonenumbers\n",
    "# !pip install pycountry\n",
    "\n",
    "import geopy.distance\n",
    "import phonenumbers\n",
    "import pycountry\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "c508ee8f",
   "metadata": {},
   "outputs": [],
   "source": [
    "pd.options.display.max_columns = 100"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "id": "f6183270",
   "metadata": {},
   "outputs": [],
   "source": [
    "path = r\"../../../../src/data\"\n",
    "lb_path_min3 = path + r\"/LocalBusiness/LocalBusiness_minimum3/geo_preprocessed\"\n",
    "lb_path_top100 = path + r\"/LocalBusiness/LocalBusiness_top100/geo_preprocessed\"\n",
    "lb_path_rest = path + r\"/LocalBusiness/LocalBusiness_rest/geo_preprocessed\"\n",
    "rest_path_min3 = path + r\"/Restaurant/Restaurant_minimum3/geo_preprocessed\"\n",
    "rest_path_top100 = path + r\"/Restaurant/Restaurant_top100/geo_preprocessed\"\n",
    "rest_path_rest = path + r\"/Restaurant/Restaurant_rest/geo_preprocessed\"\n",
    "hotel_path_min3 = path + r\"/Hotel/Hotel_minimum3/geo_preprocessed\"\n",
    "hotel_path_top100 = path + r\"/Hotel/Hotel_top100/geo_preprocessed\"\n",
    "hotel_path_rest = path + r\"/Hotel/Hotel_rest/geo_preprocessed\"\n",
    "\n",
    "\n",
    "file_path_list = [lb_path_min3, lb_path_top100, rest_path_min3, rest_path_top100, hotel_path_min3, hotel_path_top100, lb_path_rest, rest_path_rest, hotel_path_rest ]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "6282d1ef",
   "metadata": {},
   "outputs": [],
   "source": [
    "def create_df(file_path):\n",
    "    files = os.listdir(file_path)\n",
    "    df_as_list = []\n",
    "    for lb in files:\n",
    "        with gzip.open(file_path + '/' + lb, 'r') as dataFile:\n",
    "            for line in dataFile:\n",
    "                lineData = json.loads(line.decode('utf-8'))\n",
    "                lineData[\"origin\"] = lb\n",
    "                df_as_list.append(lineData)\n",
    "    df = pd.DataFrame(df_as_list)\n",
    "    return df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "c046a679",
   "metadata": {},
   "outputs": [],
   "source": [
    "df_list = []\n",
    "for file_path in file_path_list:\n",
    "    df = create_df(file_path)\n",
    "    df_list.append(df)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "0febf422",
   "metadata": {},
   "source": [
    "## Concatenate Dataframes"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "id": "b5bcc144",
   "metadata": {},
   "outputs": [],
   "source": [
    "df_all = pd.concat(df_list, axis = 0, ignore_index = True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "id": "3d134dc2",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "4561417"
      ]
     },
     "execution_count": 16,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "len(df_all)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "id": "bc4500fb",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "14053"
      ]
     },
     "execution_count": 17,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_all['origin'].nunique()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "id": "196a45df",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>row_id</th>\n",
       "      <th>name</th>\n",
       "      <th>address</th>\n",
       "      <th>description</th>\n",
       "      <th>pricerange</th>\n",
       "      <th>founder</th>\n",
       "      <th>owns</th>\n",
       "      <th>page_url</th>\n",
       "      <th>addressregion</th>\n",
       "      <th>streetaddress</th>\n",
       "      <th>addresscountry</th>\n",
       "      <th>telephone_address</th>\n",
       "      <th>addresslocality</th>\n",
       "      <th>postalcode</th>\n",
       "      <th>origin</th>\n",
       "      <th>telephone</th>\n",
       "      <th>geo</th>\n",
       "      <th>sameas</th>\n",
       "      <th>latitude</th>\n",
       "      <th>longitude</th>\n",
       "      <th>url</th>\n",
       "      <th>aggregaterating</th>\n",
       "      <th>image</th>\n",
       "      <th>openinghours</th>\n",
       "      <th>review</th>\n",
       "      <th>email</th>\n",
       "      <th>contactpoint</th>\n",
       "      <th>reviews</th>\n",
       "      <th>employees</th>\n",
       "      <th>faxnumber</th>\n",
       "      <th>about</th>\n",
       "      <th>citystatezip</th>\n",
       "      <th>openinghoursspecification</th>\n",
       "      <th>areaserved</th>\n",
       "      <th>location</th>\n",
       "      <th>paymentaccepted</th>\n",
       "      <th>currenciesaccepted</th>\n",
       "      <th>legalname</th>\n",
       "      <th>photos</th>\n",
       "      <th>photo</th>\n",
       "      <th>logo</th>\n",
       "      <th>alternatename</th>\n",
       "      <th>brand</th>\n",
       "      <th>department</th>\n",
       "      <th>makesoffer</th>\n",
       "      <th>map</th>\n",
       "      <th>award</th>\n",
       "      <th>hasmap</th>\n",
       "      <th>isicv4</th>\n",
       "      <th>foundingdate</th>\n",
       "      <th>...</th>\n",
       "      <th>acceptsreservations</th>\n",
       "      <th>haspos</th>\n",
       "      <th>availableservice</th>\n",
       "      <th>position</th>\n",
       "      <th>type</th>\n",
       "      <th>virtualcategory</th>\n",
       "      <th>audience</th>\n",
       "      <th>restaurant</th>\n",
       "      <th>golfcourse</th>\n",
       "      <th>addressname</th>\n",
       "      <th>receivinghours</th>\n",
       "      <th>namecompany</th>\n",
       "      <th>provider</th>\n",
       "      <th>hascourseinstance</th>\n",
       "      <th>serialnumber</th>\n",
       "      <th>phonenumber</th>\n",
       "      <th>\\u201daddresslocality\\u201d</th>\n",
       "      <th>text</th>\n",
       "      <th>target</th>\n",
       "      <th>pickupinfo</th>\n",
       "      <th>\\u201daddressregion\\u201d</th>\n",
       "      <th>isrelatedto</th>\n",
       "      <th>validthrough</th>\n",
       "      <th>validfrom</th>\n",
       "      <th>menu</th>\n",
       "      <th>rating</th>\n",
       "      <th>ingredients</th>\n",
       "      <th>haswifi</th>\n",
       "      <th>address2</th>\n",
       "      <th>starrating</th>\n",
       "      <th>region</th>\n",
       "      <th>restaurant-type</th>\n",
       "      <th>occasions</th>\n",
       "      <th>features</th>\n",
       "      <th>checkintime</th>\n",
       "      <th>checkouttime</th>\n",
       "      <th>petsallowed</th>\n",
       "      <th>subjectof</th>\n",
       "      <th>members</th>\n",
       "      <th>hotel-infos-details</th>\n",
       "      <th>hotel-infos-adress</th>\n",
       "      <th>offeredby</th>\n",
       "      <th>special_rate_description</th>\n",
       "      <th>hotelbrand</th>\n",
       "      <th>hotelcode</th>\n",
       "      <th>releasedate</th>\n",
       "      <th>streetlocality</th>\n",
       "      <th>streetregion</th>\n",
       "      <th>maps</th>\n",
       "      <th>occupancy</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>4561412</th>\n",
       "      <td>5185</td>\n",
       "      <td>Supalai Resort &amp; Spa Phuket</td>\n",
       "      <td>Moo 6 Ao Po Lang Daeng Road Paklok Thala,</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>https://www.onthebeach.co.uk/hotels/thailand/p...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Hotel_onthebeach.co.uk_September2020.json.gz</td>\n",
       "      <td>+66 763 02302</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>{'reviewcount': '140', 'ratingvalue': '3.5E0'}</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>{'ratingvalue': '4'}</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4561413</th>\n",
       "      <td>5186</td>\n",
       "      <td>Oba Star Hotel</td>\n",
       "      <td>Oba Mahallesi, Obagöl Mevkii, Mesut Cd., 07640...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>https://www.onthebeach.co.uk/hotels/turkey/ant...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Hotel_onthebeach.co.uk_September2020.json.gz</td>\n",
       "      <td>0090 242 514 32 83</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>{'ratingvalue': '4.5E0', 'reviewcount': '1251'}</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>{'ratingvalue': '4'}</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4561414</th>\n",
       "      <td>5187</td>\n",
       "      <td>Hotel Askoc</td>\n",
       "      <td>Istasyon Arka Sokak No 15Sirkeci 34420, Istanbul</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>https://www.onthebeach.co.uk/hotels/turkey/ist...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Hotel_onthebeach.co.uk_September2020.json.gz</td>\n",
       "      <td>902125118089</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>{'reviewcount': '148', 'ratingvalue': '3.5E0'}</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>{'ratingvalue': '4'}</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4561415</th>\n",
       "      <td>5188</td>\n",
       "      <td>Hotel Xapala</td>\n",
       "      <td>Carrer d'Amílcar, 5, 07600 El Arenal, Illes Ba...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>https://www.onthebeach.co.uk/hotels/spain/bale...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Hotel_onthebeach.co.uk_September2020.json.gz</td>\n",
       "      <td>None</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>{'ratingvalue': '4.0E0', 'reviewcount': '82'}</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>{'ratingvalue': '0'}</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4561416</th>\n",
       "      <td>5189</td>\n",
       "      <td>Hotel Best Western Amber</td>\n",
       "      <td>Muhsine Hatun Mah.Ciftegelinler Cad.No:3/7, Is...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>https://www.onthebeach.co.uk/hotels/turkey/ist...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Hotel_onthebeach.co.uk_September2020.json.gz</td>\n",
       "      <td>+90 212 518 48 01</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>None</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>{'ratingvalue': '4'}</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 267 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "         row_id                         name  \\\n",
       "4561412    5185  Supalai Resort & Spa Phuket   \n",
       "4561413    5186               Oba Star Hotel   \n",
       "4561414    5187                  Hotel Askoc   \n",
       "4561415    5188                 Hotel Xapala   \n",
       "4561416    5189     Hotel Best Western Amber   \n",
       "\n",
       "                                                   address description  \\\n",
       "4561412          Moo 6 Ao Po Lang Daeng Road Paklok Thala,         NaN   \n",
       "4561413  Oba Mahallesi, Obagöl Mevkii, Mesut Cd., 07640...         NaN   \n",
       "4561414   Istasyon Arka Sokak No 15Sirkeci 34420, Istanbul         NaN   \n",
       "4561415  Carrer d'Amílcar, 5, 07600 El Arenal, Illes Ba...         NaN   \n",
       "4561416  Muhsine Hatun Mah.Ciftegelinler Cad.No:3/7, Is...         NaN   \n",
       "\n",
       "        pricerange founder owns  \\\n",
       "4561412        NaN     NaN  NaN   \n",
       "4561413        NaN     NaN  NaN   \n",
       "4561414        NaN     NaN  NaN   \n",
       "4561415        NaN     NaN  NaN   \n",
       "4561416        NaN     NaN  NaN   \n",
       "\n",
       "                                                  page_url addressregion  \\\n",
       "4561412  https://www.onthebeach.co.uk/hotels/thailand/p...           NaN   \n",
       "4561413  https://www.onthebeach.co.uk/hotels/turkey/ant...           NaN   \n",
       "4561414  https://www.onthebeach.co.uk/hotels/turkey/ist...           NaN   \n",
       "4561415  https://www.onthebeach.co.uk/hotels/spain/bale...           NaN   \n",
       "4561416  https://www.onthebeach.co.uk/hotels/turkey/ist...           NaN   \n",
       "\n",
       "        streetaddress addresscountry telephone_address addresslocality  \\\n",
       "4561412           NaN            NaN               NaN             NaN   \n",
       "4561413           NaN            NaN               NaN             NaN   \n",
       "4561414           NaN            NaN               NaN             NaN   \n",
       "4561415           NaN            NaN               NaN             NaN   \n",
       "4561416           NaN            NaN               NaN             NaN   \n",
       "\n",
       "        postalcode                                        origin  \\\n",
       "4561412        NaN  Hotel_onthebeach.co.uk_September2020.json.gz   \n",
       "4561413        NaN  Hotel_onthebeach.co.uk_September2020.json.gz   \n",
       "4561414        NaN  Hotel_onthebeach.co.uk_September2020.json.gz   \n",
       "4561415        NaN  Hotel_onthebeach.co.uk_September2020.json.gz   \n",
       "4561416        NaN  Hotel_onthebeach.co.uk_September2020.json.gz   \n",
       "\n",
       "                  telephone  geo sameas latitude longitude  url  \\\n",
       "4561412       +66 763 02302  NaN    NaN      NaN       NaN  NaN   \n",
       "4561413  0090 242 514 32 83  NaN    NaN      NaN       NaN  NaN   \n",
       "4561414        902125118089  NaN    NaN      NaN       NaN  NaN   \n",
       "4561415                None  NaN    NaN      NaN       NaN  NaN   \n",
       "4561416   +90 212 518 48 01  NaN    NaN      NaN       NaN  NaN   \n",
       "\n",
       "                                         aggregaterating image openinghours  \\\n",
       "4561412   {'reviewcount': '140', 'ratingvalue': '3.5E0'}   NaN          NaN   \n",
       "4561413  {'ratingvalue': '4.5E0', 'reviewcount': '1251'}   NaN          NaN   \n",
       "4561414   {'reviewcount': '148', 'ratingvalue': '3.5E0'}   NaN          NaN   \n",
       "4561415    {'ratingvalue': '4.0E0', 'reviewcount': '82'}   NaN          NaN   \n",
       "4561416                                             None   NaN          NaN   \n",
       "\n",
       "        review email contactpoint reviews employees faxnumber about  \\\n",
       "4561412    NaN   NaN          NaN     NaN       NaN       NaN   NaN   \n",
       "4561413    NaN   NaN          NaN     NaN       NaN       NaN   NaN   \n",
       "4561414    NaN   NaN          NaN     NaN       NaN       NaN   NaN   \n",
       "4561415    NaN   NaN          NaN     NaN       NaN       NaN   NaN   \n",
       "4561416    NaN   NaN          NaN     NaN       NaN       NaN   NaN   \n",
       "\n",
       "        citystatezip openinghoursspecification areaserved location  \\\n",
       "4561412          NaN                       NaN        NaN      NaN   \n",
       "4561413          NaN                       NaN        NaN      NaN   \n",
       "4561414          NaN                       NaN        NaN      NaN   \n",
       "4561415          NaN                       NaN        NaN      NaN   \n",
       "4561416          NaN                       NaN        NaN      NaN   \n",
       "\n",
       "        paymentaccepted currenciesaccepted legalname photos photo logo  \\\n",
       "4561412             NaN                NaN       NaN    NaN   NaN  NaN   \n",
       "4561413             NaN                NaN       NaN    NaN   NaN  NaN   \n",
       "4561414             NaN                NaN       NaN    NaN   NaN  NaN   \n",
       "4561415             NaN                NaN       NaN    NaN   NaN  NaN   \n",
       "4561416             NaN                NaN       NaN    NaN   NaN  NaN   \n",
       "\n",
       "        alternatename brand department makesoffer  map award hasmap isicv4  \\\n",
       "4561412           NaN   NaN        NaN        NaN  NaN   NaN    NaN    NaN   \n",
       "4561413           NaN   NaN        NaN        NaN  NaN   NaN    NaN    NaN   \n",
       "4561414           NaN   NaN        NaN        NaN  NaN   NaN    NaN    NaN   \n",
       "4561415           NaN   NaN        NaN        NaN  NaN   NaN    NaN    NaN   \n",
       "4561416           NaN   NaN        NaN        NaN  NaN   NaN    NaN    NaN   \n",
       "\n",
       "        foundingdate  ... acceptsreservations haspos availableservice  \\\n",
       "4561412          NaN  ...                 NaN    NaN              NaN   \n",
       "4561413          NaN  ...                 NaN    NaN              NaN   \n",
       "4561414          NaN  ...                 NaN    NaN              NaN   \n",
       "4561415          NaN  ...                 NaN    NaN              NaN   \n",
       "4561416          NaN  ...                 NaN    NaN              NaN   \n",
       "\n",
       "        position type  virtualcategory audience restaurant golfcourse  \\\n",
       "4561412      NaN  NaN              NaN      NaN        NaN        NaN   \n",
       "4561413      NaN  NaN              NaN      NaN        NaN        NaN   \n",
       "4561414      NaN  NaN              NaN      NaN        NaN        NaN   \n",
       "4561415      NaN  NaN              NaN      NaN        NaN        NaN   \n",
       "4561416      NaN  NaN              NaN      NaN        NaN        NaN   \n",
       "\n",
       "        addressname receivinghours namecompany provider hascourseinstance  \\\n",
       "4561412         NaN            NaN         NaN      NaN               NaN   \n",
       "4561413         NaN            NaN         NaN      NaN               NaN   \n",
       "4561414         NaN            NaN         NaN      NaN               NaN   \n",
       "4561415         NaN            NaN         NaN      NaN               NaN   \n",
       "4561416         NaN            NaN         NaN      NaN               NaN   \n",
       "\n",
       "        serialnumber phonenumber  \\u201daddresslocality\\u201d  text target  \\\n",
       "4561412          NaN         NaN                          NaN   NaN    NaN   \n",
       "4561413          NaN         NaN                          NaN   NaN    NaN   \n",
       "4561414          NaN         NaN                          NaN   NaN    NaN   \n",
       "4561415          NaN         NaN                          NaN   NaN    NaN   \n",
       "4561416          NaN         NaN                          NaN   NaN    NaN   \n",
       "\n",
       "        pickupinfo \\u201daddressregion\\u201d isrelatedto validthrough  \\\n",
       "4561412        NaN                       NaN         NaN          NaN   \n",
       "4561413        NaN                       NaN         NaN          NaN   \n",
       "4561414        NaN                       NaN         NaN          NaN   \n",
       "4561415        NaN                       NaN         NaN          NaN   \n",
       "4561416        NaN                       NaN         NaN          NaN   \n",
       "\n",
       "        validfrom menu rating ingredients haswifi address2  \\\n",
       "4561412       NaN  NaN    NaN         NaN     NaN      NaN   \n",
       "4561413       NaN  NaN    NaN         NaN     NaN      NaN   \n",
       "4561414       NaN  NaN    NaN         NaN     NaN      NaN   \n",
       "4561415       NaN  NaN    NaN         NaN     NaN      NaN   \n",
       "4561416       NaN  NaN    NaN         NaN     NaN      NaN   \n",
       "\n",
       "                   starrating region restaurant-type occasions features  \\\n",
       "4561412  {'ratingvalue': '4'}    NaN             NaN       NaN      NaN   \n",
       "4561413  {'ratingvalue': '4'}    NaN             NaN       NaN      NaN   \n",
       "4561414  {'ratingvalue': '4'}    NaN             NaN       NaN      NaN   \n",
       "4561415  {'ratingvalue': '0'}    NaN             NaN       NaN      NaN   \n",
       "4561416  {'ratingvalue': '4'}    NaN             NaN       NaN      NaN   \n",
       "\n",
       "        checkintime  checkouttime petsallowed subjectof members  \\\n",
       "4561412         NaN           NaN         NaN       NaN     NaN   \n",
       "4561413         NaN           NaN         NaN       NaN     NaN   \n",
       "4561414         NaN           NaN         NaN       NaN     NaN   \n",
       "4561415         NaN           NaN         NaN       NaN     NaN   \n",
       "4561416         NaN           NaN         NaN       NaN     NaN   \n",
       "\n",
       "        hotel-infos-details hotel-infos-adress offeredby  \\\n",
       "4561412                 NaN                NaN       NaN   \n",
       "4561413                 NaN                NaN       NaN   \n",
       "4561414                 NaN                NaN       NaN   \n",
       "4561415                 NaN                NaN       NaN   \n",
       "4561416                 NaN                NaN       NaN   \n",
       "\n",
       "        special_rate_description hotelbrand hotelcode releasedate  \\\n",
       "4561412                      NaN        NaN       NaN         NaN   \n",
       "4561413                      NaN        NaN       NaN         NaN   \n",
       "4561414                      NaN        NaN       NaN         NaN   \n",
       "4561415                      NaN        NaN       NaN         NaN   \n",
       "4561416                      NaN        NaN       NaN         NaN   \n",
       "\n",
       "        streetlocality streetregion maps occupancy  \n",
       "4561412            NaN          NaN  NaN       NaN  \n",
       "4561413            NaN          NaN  NaN       NaN  \n",
       "4561414            NaN          NaN  NaN       NaN  \n",
       "4561415            NaN          NaN  NaN       NaN  \n",
       "4561416            NaN          NaN  NaN       NaN  \n",
       "\n",
       "[5 rows x 267 columns]"
      ]
     },
     "execution_count": 15,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_all.tail()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "4953717f",
   "metadata": {},
   "source": [
    "# Tables after getting rid off empy phone - and country codes"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "id": "50cc3b46",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "4595"
      ]
     },
     "execution_count": 18,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_clean_phone = df_all[df_all[\"addresscountry\"].notna()]\n",
    "df_clean_phone = df_clean_phone[df_clean_phone[\"telephone\"].notna()]\n",
    "#len(df_clean_phone)\n",
    "df_clean_phone[\"origin\"].nunique()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "5aed7895",
   "metadata": {},
   "source": [
    "# Tables after getting rid empy phone - and country codes"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "5c517868",
   "metadata": {},
   "outputs": [],
   "source": [
    "# df_clean_geo = df_all[df_all[\"longitude\"].notna()]\n",
    "# df_clean_geo = df_clean_geo[df_clean_geo[\"latitude\"].notna()]\n",
    "# df_clean_geo[\"origin\"].nunique()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "deb4e656",
   "metadata": {},
   "outputs": [],
   "source": [
    "# df_clean_phone_geo = df_clean_phone[df_clean_phone[\"longitude\"].notna()]\n",
    "# df_clean_phone_geo = df_clean_phone_geo[df_clean_phone_geo[\"latitude\"].notna()]\n",
    "# df_clean_phone_geo[\"origin\"].nunique()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "5482c198",
   "metadata": {},
   "source": [
    "### Roughly 1.3 mio data after conditioning on phone and non-zero country codes"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "39d67a0f",
   "metadata": {},
   "source": [
    "## Format longitudes AND latitudes"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "95fb5e4c",
   "metadata": {},
   "outputs": [],
   "source": [
    "# lon = \"longitude\"\n",
    "# lat = \"latitude\""
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "39c1ac01",
   "metadata": {},
   "outputs": [],
   "source": [
    "# # Remove entries that are not numbers or cannot be convertred to one number (list etc.)\n",
    "# longitudes = df_clean_geo[lon].to_numpy()\n",
    "# latitudes = df_clean_geo[lat].to_numpy()\n",
    "# deleteList = []\n",
    "# i = 0\n",
    "\n",
    "# for value in longitudes:\n",
    "#     if ((isinstance(value, str) == False) & (isinstance(value, float) == False)):\n",
    "#         deleteList.append(i)\n",
    "#     i = i + 1\n",
    "\n",
    "# i = 0\n",
    "# for value in latitudes:\n",
    "#     if ((isinstance(value, str) == False) & (isinstance(value, float) == False)):\n",
    "#         deleteList.append(i)\n",
    "#     i = i + 1    \n",
    "\n",
    "# df_clean_geo.drop(df_clean_geo.index[deleteList], axis = 0, inplace = True)        "
   ]
  },
  {
   "cell_type": "markdown",
   "id": "e0e18ecc",
   "metadata": {},
   "source": [
    "### Format longitude and latitude"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f5624f85",
   "metadata": {},
   "outputs": [],
   "source": [
    "# longArray = df_clean_geo[lon].to_numpy().astype(str)\n",
    "# longArray = np.char.replace(longArray, ',', '.')\n",
    "# longArray = np.char.replace(longArray, '--', '-')\n",
    "# df_clean_geo[lon] = longArray\n",
    "# df_clean_geo[lon] = pd.to_numeric(df_clean_geo[lon], errors='coerce')\n",
    "\n",
    "# latArray = df_clean_geo[lat].to_numpy().astype(str)\n",
    "# latArray = np.char.replace(latArray, ',', '.')\n",
    "# latArray = np.char.replace(latArray, '--', '-')\n",
    "# df_clean_geo[lat] = latArray\n",
    "# df_clean_geo[lat] = pd.to_numeric(df_clean_geo[lat], errors='coerce')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f7b664c6",
   "metadata": {},
   "outputs": [],
   "source": [
    "# # Remove the entries that were set to NaN because of other errors\n",
    "# df_clean_geo = df_clean_geo[df_clean_geo[\"longitude\"].notna()]\n",
    "# df_clean_geo = df_clean_geo[df_clean_geo[\"latitude\"].notna()]\n",
    "# # Make sure to only include valid longitudes and latitudes\n",
    "# df_clean_geo = df_clean_geo.loc[(df_clean_geo[lat] >= -90) & (df_clean_geo[lat] <= 90)]\n",
    "# df_clean_geo = df_clean_geo.loc[(df_clean_geo[lon] >= -180) & (df_clean_geo[lon] <= 80)]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "25c2450c",
   "metadata": {},
   "outputs": [],
   "source": [
    "# df_clean_geo[\"origin\"].nunqiue()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "ef4c47d7",
   "metadata": {},
   "source": [
    "### Roughly 700k datapoints left after conditioning on geo-location"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "8717ec5f",
   "metadata": {},
   "source": [
    "## Further preprocessing step\n",
    "\n",
    "### Remove non-digits from telephone numbers"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "id": "bf49cc9e",
   "metadata": {},
   "outputs": [],
   "source": [
    "def remove_non_digits(string):\n",
    "    cleaned = re.sub('[^0-9]','', string)\n",
    "    return cleaned"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "id": "292d2de8",
   "metadata": {},
   "outputs": [],
   "source": [
    "df_clean = df_clean_phone[[\"row_id\", \"address\", \"page_url\", \"origin\", \"telephone\" , \"addresscountry\", \"longitude\", \"latitude\"]]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "id": "cb29434b",
   "metadata": {},
   "outputs": [],
   "source": [
    "df_clean['telephone_'] = df_clean['telephone'].astype('str').apply(remove_non_digits)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "cf025d67",
   "metadata": {},
   "source": [
    "### Extract country codes to ISO-2 format using ``pycountry``"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "id": "3305cc74",
   "metadata": {
    "scrolled": false
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "{'Aruba': 'AW',\n",
       " 'Afghanistan': 'AF',\n",
       " 'Angola': 'AO',\n",
       " 'Anguilla': 'AI',\n",
       " 'Åland Islands': 'AX',\n",
       " 'Albania': 'AL',\n",
       " 'Andorra': 'AD',\n",
       " 'United Arab Emirates': 'AE',\n",
       " 'Argentina': 'AR',\n",
       " 'Armenia': 'AM',\n",
       " 'American Samoa': 'AS',\n",
       " 'Antarctica': 'AQ',\n",
       " 'French Southern Territories': 'TF',\n",
       " 'Antigua and Barbuda': 'AG',\n",
       " 'Australia': 'AU',\n",
       " 'Austria': 'AT',\n",
       " 'Azerbaijan': 'AZ',\n",
       " 'Burundi': 'BI',\n",
       " 'Belgium': 'BE',\n",
       " 'Benin': 'BJ',\n",
       " 'Bonaire, Sint Eustatius and Saba': 'BQ',\n",
       " 'Burkina Faso': 'BF',\n",
       " 'Bangladesh': 'BD',\n",
       " 'Bulgaria': 'BG',\n",
       " 'Bahrain': 'BH',\n",
       " 'Bahamas': 'BS',\n",
       " 'Bosnia and Herzegovina': 'BA',\n",
       " 'Saint Barthélemy': 'BL',\n",
       " 'Belarus': 'BY',\n",
       " 'Belize': 'BZ',\n",
       " 'Bermuda': 'BM',\n",
       " 'Bolivia, Plurinational State of': 'BO',\n",
       " 'Brazil': 'BR',\n",
       " 'Barbados': 'BB',\n",
       " 'Brunei Darussalam': 'BN',\n",
       " 'Bhutan': 'BT',\n",
       " 'Bouvet Island': 'BV',\n",
       " 'Botswana': 'BW',\n",
       " 'Central African Republic': 'CF',\n",
       " 'Canada': 'CA',\n",
       " 'Cocos (Keeling) Islands': 'CC',\n",
       " 'Switzerland': 'CH',\n",
       " 'Chile': 'CL',\n",
       " 'China': 'CN',\n",
       " \"Côte d'Ivoire\": 'CI',\n",
       " 'Cameroon': 'CM',\n",
       " 'Congo, The Democratic Republic of the': 'CD',\n",
       " 'Congo': 'CG',\n",
       " 'Cook Islands': 'CK',\n",
       " 'Colombia': 'CO',\n",
       " 'Comoros': 'KM',\n",
       " 'Cabo Verde': 'CV',\n",
       " 'Costa Rica': 'CR',\n",
       " 'Cuba': 'CU',\n",
       " 'Curaçao': 'CW',\n",
       " 'Christmas Island': 'CX',\n",
       " 'Cayman Islands': 'KY',\n",
       " 'Cyprus': 'CY',\n",
       " 'Czechia': 'CZ',\n",
       " 'Germany': 'DE',\n",
       " 'Djibouti': 'DJ',\n",
       " 'Dominica': 'DM',\n",
       " 'Denmark': 'DK',\n",
       " 'Dominican Republic': 'DO',\n",
       " 'Algeria': 'DZ',\n",
       " 'Ecuador': 'EC',\n",
       " 'Egypt': 'EG',\n",
       " 'Eritrea': 'ER',\n",
       " 'Western Sahara': 'EH',\n",
       " 'Spain': 'ES',\n",
       " 'Estonia': 'EE',\n",
       " 'Ethiopia': 'ET',\n",
       " 'Finland': 'FI',\n",
       " 'Fiji': 'FJ',\n",
       " 'Falkland Islands (Malvinas)': 'FK',\n",
       " 'France': 'FR',\n",
       " 'Faroe Islands': 'FO',\n",
       " 'Micronesia, Federated States of': 'FM',\n",
       " 'Gabon': 'GA',\n",
       " 'United Kingdom': 'GB',\n",
       " 'Georgia': 'GE',\n",
       " 'Guernsey': 'GG',\n",
       " 'Ghana': 'GH',\n",
       " 'Gibraltar': 'GI',\n",
       " 'Guinea': 'GN',\n",
       " 'Guadeloupe': 'GP',\n",
       " 'Gambia': 'GM',\n",
       " 'Guinea-Bissau': 'GW',\n",
       " 'Equatorial Guinea': 'GQ',\n",
       " 'Greece': 'GR',\n",
       " 'Grenada': 'GD',\n",
       " 'Greenland': 'GL',\n",
       " 'Guatemala': 'GT',\n",
       " 'French Guiana': 'GF',\n",
       " 'Guam': 'GU',\n",
       " 'Guyana': 'GY',\n",
       " 'Hong Kong': 'HK',\n",
       " 'Heard Island and McDonald Islands': 'HM',\n",
       " 'Honduras': 'HN',\n",
       " 'Croatia': 'HR',\n",
       " 'Haiti': 'HT',\n",
       " 'Hungary': 'HU',\n",
       " 'Indonesia': 'ID',\n",
       " 'Isle of Man': 'IM',\n",
       " 'India': 'IN',\n",
       " 'British Indian Ocean Territory': 'IO',\n",
       " 'Ireland': 'IE',\n",
       " 'Iran, Islamic Republic of': 'IR',\n",
       " 'Iraq': 'IQ',\n",
       " 'Iceland': 'IS',\n",
       " 'Israel': 'IL',\n",
       " 'Italy': 'IT',\n",
       " 'Jamaica': 'JM',\n",
       " 'Jersey': 'JE',\n",
       " 'Jordan': 'JO',\n",
       " 'Japan': 'JP',\n",
       " 'Kazakhstan': 'KZ',\n",
       " 'Kenya': 'KE',\n",
       " 'Kyrgyzstan': 'KG',\n",
       " 'Cambodia': 'KH',\n",
       " 'Kiribati': 'KI',\n",
       " 'Saint Kitts and Nevis': 'KN',\n",
       " 'Korea, Republic of': 'KR',\n",
       " 'Kuwait': 'KW',\n",
       " \"Lao People's Democratic Republic\": 'LA',\n",
       " 'Lebanon': 'LB',\n",
       " 'Liberia': 'LR',\n",
       " 'Libya': 'LY',\n",
       " 'Saint Lucia': 'LC',\n",
       " 'Liechtenstein': 'LI',\n",
       " 'Sri Lanka': 'LK',\n",
       " 'Lesotho': 'LS',\n",
       " 'Lithuania': 'LT',\n",
       " 'Luxembourg': 'LU',\n",
       " 'Latvia': 'LV',\n",
       " 'Macao': 'MO',\n",
       " 'Saint Martin (French part)': 'MF',\n",
       " 'Morocco': 'MA',\n",
       " 'Monaco': 'MC',\n",
       " 'Moldova, Republic of': 'MD',\n",
       " 'Madagascar': 'MG',\n",
       " 'Maldives': 'MV',\n",
       " 'Mexico': 'MX',\n",
       " 'Marshall Islands': 'MH',\n",
       " 'North Macedonia': 'MK',\n",
       " 'Mali': 'ML',\n",
       " 'Malta': 'MT',\n",
       " 'Myanmar': 'MM',\n",
       " 'Montenegro': 'ME',\n",
       " 'Mongolia': 'MN',\n",
       " 'Northern Mariana Islands': 'MP',\n",
       " 'Mozambique': 'MZ',\n",
       " 'Mauritania': 'MR',\n",
       " 'Montserrat': 'MS',\n",
       " 'Martinique': 'MQ',\n",
       " 'Mauritius': 'MU',\n",
       " 'Malawi': 'MW',\n",
       " 'Malaysia': 'MY',\n",
       " 'Mayotte': 'YT',\n",
       " 'Namibia': 'NA',\n",
       " 'New Caledonia': 'NC',\n",
       " 'Niger': 'NE',\n",
       " 'Norfolk Island': 'NF',\n",
       " 'Nigeria': 'NG',\n",
       " 'Nicaragua': 'NI',\n",
       " 'Niue': 'NU',\n",
       " 'Netherlands': 'NL',\n",
       " 'Norway': 'NO',\n",
       " 'Nepal': 'NP',\n",
       " 'Nauru': 'NR',\n",
       " 'New Zealand': 'NZ',\n",
       " 'Oman': 'OM',\n",
       " 'Pakistan': 'PK',\n",
       " 'Panama': 'PA',\n",
       " 'Pitcairn': 'PN',\n",
       " 'Peru': 'PE',\n",
       " 'Philippines': 'PH',\n",
       " 'Palau': 'PW',\n",
       " 'Papua New Guinea': 'PG',\n",
       " 'Poland': 'PL',\n",
       " 'Puerto Rico': 'PR',\n",
       " \"Korea, Democratic People's Republic of\": 'KP',\n",
       " 'Portugal': 'PT',\n",
       " 'Paraguay': 'PY',\n",
       " 'Palestine, State of': 'PS',\n",
       " 'French Polynesia': 'PF',\n",
       " 'Qatar': 'QA',\n",
       " 'Réunion': 'RE',\n",
       " 'Romania': 'RO',\n",
       " 'Russian Federation': 'RU',\n",
       " 'Rwanda': 'RW',\n",
       " 'Saudi Arabia': 'SA',\n",
       " 'Sudan': 'SD',\n",
       " 'Senegal': 'SN',\n",
       " 'Singapore': 'SG',\n",
       " 'South Georgia and the South Sandwich Islands': 'GS',\n",
       " 'Saint Helena, Ascension and Tristan da Cunha': 'SH',\n",
       " 'Svalbard and Jan Mayen': 'SJ',\n",
       " 'Solomon Islands': 'SB',\n",
       " 'Sierra Leone': 'SL',\n",
       " 'El Salvador': 'SV',\n",
       " 'San Marino': 'SM',\n",
       " 'Somalia': 'SO',\n",
       " 'Saint Pierre and Miquelon': 'PM',\n",
       " 'Serbia': 'RS',\n",
       " 'South Sudan': 'SS',\n",
       " 'Sao Tome and Principe': 'ST',\n",
       " 'Suriname': 'SR',\n",
       " 'Slovakia': 'SK',\n",
       " 'Slovenia': 'SI',\n",
       " 'Sweden': 'SE',\n",
       " 'Eswatini': 'SZ',\n",
       " 'Sint Maarten (Dutch part)': 'SX',\n",
       " 'Seychelles': 'SC',\n",
       " 'Syrian Arab Republic': 'SY',\n",
       " 'Turks and Caicos Islands': 'TC',\n",
       " 'Chad': 'TD',\n",
       " 'Togo': 'TG',\n",
       " 'Thailand': 'TH',\n",
       " 'Tajikistan': 'TJ',\n",
       " 'Tokelau': 'TK',\n",
       " 'Turkmenistan': 'TM',\n",
       " 'Timor-Leste': 'TL',\n",
       " 'Tonga': 'TO',\n",
       " 'Trinidad and Tobago': 'TT',\n",
       " 'Tunisia': 'TN',\n",
       " 'Turkey': 'TR',\n",
       " 'Tuvalu': 'TV',\n",
       " 'Taiwan, Province of China': 'TW',\n",
       " 'Tanzania, United Republic of': 'TZ',\n",
       " 'Uganda': 'UG',\n",
       " 'Ukraine': 'UA',\n",
       " 'United States Minor Outlying Islands': 'UM',\n",
       " 'Uruguay': 'UY',\n",
       " 'United States': 'US',\n",
       " 'Uzbekistan': 'UZ',\n",
       " 'Holy See (Vatican City State)': 'VA',\n",
       " 'Saint Vincent and the Grenadines': 'VC',\n",
       " 'Venezuela, Bolivarian Republic of': 'VE',\n",
       " 'Virgin Islands, British': 'VG',\n",
       " 'Virgin Islands, U.S.': 'VI',\n",
       " 'Viet Nam': 'VN',\n",
       " 'Vanuatu': 'VU',\n",
       " 'Wallis and Futuna': 'WF',\n",
       " 'Samoa': 'WS',\n",
       " 'Yemen': 'YE',\n",
       " 'South Africa': 'ZA',\n",
       " 'Zambia': 'ZM',\n",
       " 'Zimbabwe': 'ZW'}"
      ]
     },
     "execution_count": 17,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "countries = {}\n",
    "for country in pycountry.countries:\n",
    "    countries[country.name] = country.alpha_2\n",
    "\n",
    "countries\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "id": "552d72f6",
   "metadata": {},
   "outputs": [],
   "source": [
    "# fuction to modify the country dictionary in uppercase\n",
    "def modify_dic(d):\n",
    "    for key in list(d.keys()):\n",
    "        new_key = key.upper()\n",
    "        d[new_key] = d[key]\n",
    "    return d"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "id": "263667a9",
   "metadata": {},
   "outputs": [],
   "source": [
    "countries_upper = modify_dic(countries)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "id": "2d456445",
   "metadata": {
    "scrolled": false
   },
   "outputs": [],
   "source": [
    "#countries_upper"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "id": "4de88e0a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#uppercase the df_column \n",
    "df_clean[\"addresscountry\"] = df_clean[\"addresscountry\"].str.upper()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "id": "c60d4e33",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "UNITED STATES     205464\n",
       "US                149645\n",
       "UNITED KINGDOM     44700\n",
       "USA                44247\n",
       "INDIA              25576\n",
       "                   ...  \n",
       "VENESUELA              1\n",
       "NAURU                  1\n",
       "UNITED-STATES          1\n",
       "GREENLAND              1\n",
       "GUADELOUPE             1\n",
       "Name: addresscountry, Length: 1134, dtype: int64"
      ]
     },
     "execution_count": 22,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_clean[\"addresscountry\"].value_counts()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "id": "5dfdd736",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "<ipython-input-23-05d220ee92af>:3: FutureWarning: The default value of regex will change from True to False in a future version.\n",
      "  df_clean[\"addresscountry\"] = df_clean[\"addresscountry\"].str.replace(key, value)\n"
     ]
    }
   ],
   "source": [
    "# Replace known countries with ISO-2 format country code\n",
    "for key, value in countries_upper.items():\n",
    "    df_clean[\"addresscountry\"] = df_clean[\"addresscountry\"].str.replace(key, value)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "e2f76d3b",
   "metadata": {},
   "source": [
    "## Manually normalize countries which do not exist in country package"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "id": "558fea52",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "US             355109\n",
       "GB              59076\n",
       "USA             44247\n",
       "IN              33797\n",
       "FR              23233\n",
       "CA              22363\n",
       "UK              17082\n",
       "DE              15930\n",
       "BR              15868\n",
       "CL               8195\n",
       "ES               7923\n",
       "IT               6875\n",
       "DK               5899\n",
       "AE               5183\n",
       "MX               4957\n",
       "TR               3510\n",
       "ENGLAND          3301\n",
       "CO               2967\n",
       "ITALIA           2817\n",
       "NO               2733\n",
       "SVERIGE          2689\n",
       "DEUTSCHLAND      2561\n",
       "DEU              2341\n",
       "SI               2137\n",
       "UAE              1945\n",
       "NL               1873\n",
       "AT               1823\n",
       "PT               1794\n",
       "BE               1770\n",
       "ZA               1686\n",
       "Name: addresscountry, dtype: int64"
      ]
     },
     "execution_count": 24,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_clean[\"addresscountry\"].value_counts().head(30)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "id": "409afec1",
   "metadata": {},
   "outputs": [],
   "source": [
    "country_dictionary = {\n",
    "                      \"UNITED STATES\": \"US\",\n",
    "                      \"USA\":\"US\",\n",
    "                      \"UNITED KINGDOM\": \"GB\",\n",
    "                      \"UK\": \"GB\",\n",
    "                      \"CANADA\": \"CA\",\n",
    "                      \"AUSTRALIA\": \"AU\",\n",
    "                      \"UNITED ARAB EMIRATES\":\"AE\",\n",
    "                        \"UAE\": \"AE\",\n",
    "                      \"INDIA\" : \"IN\",\n",
    "                      \"NEW ZEALAND\": \"NZ\",\n",
    "                      \"SVERIGE\" : \"SE\",\n",
    "                      \"DEUTSCHLAND\": \"DE\",\n",
    "                        \"DEU\": \"DE\",\n",
    "                      \"RUSSIA\": \"RU\",\n",
    "                      \"ITALIA\": \"IT\",\n",
    "                      \"IRAN\": \"IR\",\n",
    "                      \", IN\" : \"IN\",\n",
    "                      \"ENGLAND\": \"GB\",\n",
    "                        \"FRA\": \"FR\"\n",
    "                    }\n",
    "for key, value in country_dictionary.items():\n",
    "    df_clean[\"addresscountry\"] = df_clean[\"addresscountry\"].str.replace(key, value)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "4b6b5ac1",
   "metadata": {},
   "source": [
    "## In this manual step we save about 50k extra datapoints"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "2c8fa659",
   "metadata": {},
   "source": [
    "## Remove non-covered countries\n",
    "\n",
    "### There are still some uncovered cases left which have to be removed"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "id": "9b8db2c8",
   "metadata": {},
   "outputs": [],
   "source": [
    "df_clean.reset_index(inplace=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 27,
   "id": "31744016",
   "metadata": {},
   "outputs": [],
   "source": [
    "liste = []\n",
    "for i, row in enumerate(df_clean[\"addresscountry\"]):\n",
    "    if len(row) > 2:\n",
    "        liste.append(i)\n",
    "        \n",
    "df_clean = df_clean.drop(liste)        "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 28,
   "id": "873ec4fe",
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array(['ES', 'AE', 'NL', 'PT', 'AT', 'DE', 'GR', 'QA', 'GB', 'IE', 'IS',\n",
       "       'FI', 'MT', 'NO', 'CH', 'SE', 'US', 'CA', 'DK', 'IN', 'RU', '俄国',\n",
       "       'BR', 'MX', 'ZA', 'PE', 'PK', 'BZ', 'SK', 'BE', 'PL', 'IT', 'FR',\n",
       "       'GN', 'TR', 'SA', 'AU', 'EG', 'CU', 'UA', 'CY', 'KY', 'AR', 'LI',\n",
       "       'DZ', 'GY', 'BA', 'BW', 'AZ', 'MZ', 'KW', 'TT', 'MA', 'LY', 'LK',\n",
       "       'GE', 'JM', 'PY', 'EE', 'AF', 'JE', 'GI', 'GG', 'ME', 'MV', 'CR',\n",
       "       'AM', 'BH', 'HU', 'RW', 'JO', 'SV', 'BB', 'GT', 'CO', 'BS', 'OM',\n",
       "       'GA', 'MU', 'BG', 'KE', 'SN', 'TD', 'LU', 'LC', 'MG', 'IM', '오만',\n",
       "       'NI', 'BM', 'AW', 'UG', 'HR', 'AL', 'LV', 'AO', 'UY', 'UZ', 'MK',\n",
       "       '맨섬', '인도', '건지', 'GL', 'PA', '저지', '米国', 'SI', '케냐', 'TN', 'RS',\n",
       "       '차드', '가봉', '독일', '英国', '몰타', 'SY', 'KN', 'PR', 'FL', 'MD', 'BO',\n",
       "       'LT', 'BF', 'BJ', 'ET', 'IL', 'TH', 'TZ', 'KG', 'CZ', 'LB', 'CL',\n",
       "       'MM', 'ZM', 'KZ', 'SC', 'MC', 'EC', 'IR', 'FJ', 'HN', 'SM', 'CM',\n",
       "       'NA', 'BY', 'SG', 'GH', 'ZW', 'MW', 'BI', 'LS', 'RE', 'A', 'CN',\n",
       "       'RO', 'CW', 'GD', 'VC', 'AG', 'TC', 'AS', 'HK', 'TM', 'AD', 'NZ',\n",
       "       'MY', 'GU', 'MF', 'VG', 'GP', 'NR', 'PH', 'NC', 'JP', 'ID', 'HT',\n",
       "       'EN', 'CS', 'DJ', 'MQ', 'DM', 'PF', 'VU', 'DO', 'BL', '约旦', '巴林',\n",
       "       '荷兰', 'ML', '挪威', 'SL', '芬兰', 'KH', 'AI', 'CK', 'P', '美国', '德国',\n",
       "       'CE', 'TJ', 'WS', '中国', 'SR', '美', '法国', '巴西', '미국', '智利', '영국',\n",
       "       '瑞典', 'チリ'], dtype=object)"
      ]
     },
     "execution_count": 28,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_clean[\"addresscountry\"].unique()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "a2876881",
   "metadata": {},
   "source": [
    "## Drop empty phonenumbers and too lengthy phone numbers"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 29,
   "id": "526099e9",
   "metadata": {},
   "outputs": [],
   "source": [
    "df_clean = df_clean[df_clean[\"telephone_\"] != \"\" ]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 30,
   "id": "0619c4d5",
   "metadata": {},
   "outputs": [],
   "source": [
    "liste = []\n",
    "df_clean.reset_index(inplace=True)\n",
    "for row_index in df_clean.index:\n",
    "    if len(df_clean.iloc[row_index][\"telephone_\"])>18:\n",
    "        liste.append(row_index)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 31,
   "id": "4d9e9e79",
   "metadata": {},
   "outputs": [],
   "source": [
    "df_clean.drop(labels = liste, inplace = True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 32,
   "id": "5f438c7c",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>row_id</th>\n",
       "      <th>name</th>\n",
       "      <th>address</th>\n",
       "      <th>description</th>\n",
       "      <th>pricerange</th>\n",
       "      <th>founder</th>\n",
       "      <th>owns</th>\n",
       "      <th>page_url</th>\n",
       "      <th>addressregion</th>\n",
       "      <th>streetaddress</th>\n",
       "      <th>addresscountry</th>\n",
       "      <th>telephone_address</th>\n",
       "      <th>addresslocality</th>\n",
       "      <th>postalcode</th>\n",
       "      <th>origin</th>\n",
       "      <th>telephone</th>\n",
       "      <th>geo</th>\n",
       "      <th>sameas</th>\n",
       "      <th>latitude</th>\n",
       "      <th>longitude</th>\n",
       "      <th>url</th>\n",
       "      <th>aggregaterating</th>\n",
       "      <th>image</th>\n",
       "      <th>openinghours</th>\n",
       "      <th>review</th>\n",
       "      <th>email</th>\n",
       "      <th>contactpoint</th>\n",
       "      <th>reviews</th>\n",
       "      <th>employees</th>\n",
       "      <th>faxnumber</th>\n",
       "      <th>about</th>\n",
       "      <th>citystatezip</th>\n",
       "      <th>openinghoursspecification</th>\n",
       "      <th>areaserved</th>\n",
       "      <th>location</th>\n",
       "      <th>paymentaccepted</th>\n",
       "      <th>currenciesaccepted</th>\n",
       "      <th>legalname</th>\n",
       "      <th>photos</th>\n",
       "      <th>photo</th>\n",
       "      <th>logo</th>\n",
       "      <th>alternatename</th>\n",
       "      <th>brand</th>\n",
       "      <th>department</th>\n",
       "      <th>makesoffer</th>\n",
       "      <th>map</th>\n",
       "      <th>award</th>\n",
       "      <th>hasmap</th>\n",
       "      <th>isicv4</th>\n",
       "      <th>foundingdate</th>\n",
       "      <th>...</th>\n",
       "      <th>haspos</th>\n",
       "      <th>availableservice</th>\n",
       "      <th>position</th>\n",
       "      <th>type</th>\n",
       "      <th>virtualcategory</th>\n",
       "      <th>audience</th>\n",
       "      <th>restaurant</th>\n",
       "      <th>golfcourse</th>\n",
       "      <th>addressname</th>\n",
       "      <th>receivinghours</th>\n",
       "      <th>namecompany</th>\n",
       "      <th>provider</th>\n",
       "      <th>hascourseinstance</th>\n",
       "      <th>serialnumber</th>\n",
       "      <th>phonenumber</th>\n",
       "      <th>\\u201daddresslocality\\u201d</th>\n",
       "      <th>text</th>\n",
       "      <th>target</th>\n",
       "      <th>pickupinfo</th>\n",
       "      <th>\\u201daddressregion\\u201d</th>\n",
       "      <th>isrelatedto</th>\n",
       "      <th>validthrough</th>\n",
       "      <th>validfrom</th>\n",
       "      <th>menu</th>\n",
       "      <th>rating</th>\n",
       "      <th>ingredients</th>\n",
       "      <th>haswifi</th>\n",
       "      <th>address2</th>\n",
       "      <th>starrating</th>\n",
       "      <th>region</th>\n",
       "      <th>restaurant-type</th>\n",
       "      <th>occasions</th>\n",
       "      <th>features</th>\n",
       "      <th>checkintime</th>\n",
       "      <th>checkouttime</th>\n",
       "      <th>petsallowed</th>\n",
       "      <th>subjectof</th>\n",
       "      <th>members</th>\n",
       "      <th>hotel-infos-details</th>\n",
       "      <th>hotel-infos-adress</th>\n",
       "      <th>offeredby</th>\n",
       "      <th>special_rate_description</th>\n",
       "      <th>hotelbrand</th>\n",
       "      <th>hotelcode</th>\n",
       "      <th>releasedate</th>\n",
       "      <th>streetlocality</th>\n",
       "      <th>streetregion</th>\n",
       "      <th>maps</th>\n",
       "      <th>occupancy</th>\n",
       "      <th>telephone_</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>673461</th>\n",
       "      <td>9996</td>\n",
       "      <td>None</td>\n",
       "      <td>{'streetaddress': 'Centre Island, Waterways, L...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>https://www.ihg.com/hotelindigo/destinations/c...</td>\n",
       "      <td>None</td>\n",
       "      <td>Centre Island, Waterways, Lower Mersey Street</td>\n",
       "      <td>英国</td>\n",
       "      <td>None</td>\n",
       "      <td>Ellesmere Port</td>\n",
       "      <td>CH65 2AL</td>\n",
       "      <td>Hotel_ihg.com_September2020.json.gz</td>\n",
       "      <td>44-151-3568111</td>\n",
       "      <td>{'longitude': '-2.8944E0', 'latitude': '5.3290...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>53.290300</td>\n",
       "      <td>-2.894400</td>\n",
       "      <td>NaN</td>\n",
       "      <td>{'bestrating': '5.0', 'ratingvalue': '4.6', 'r...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>None</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>441513568111</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>673462</th>\n",
       "      <td>9999</td>\n",
       "      <td>None</td>\n",
       "      <td>{'streetaddress': '12217 4th Street', 'address...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>https://www.ihg.com/holidayinnexpress/destinat...</td>\n",
       "      <td>COLOMBIE BRITANNIQUE</td>\n",
       "      <td>12217 4th Street</td>\n",
       "      <td>CA</td>\n",
       "      <td>None</td>\n",
       "      <td>Dawson Creek</td>\n",
       "      <td>V1G 0A4</td>\n",
       "      <td>Hotel_ihg.com_September2020.json.gz</td>\n",
       "      <td>1-250-7827700</td>\n",
       "      <td>{'longitude': '-1.20216293E2', 'latitude': '5....</td>\n",
       "      <td>NaN</td>\n",
       "      <td>55.737782</td>\n",
       "      <td>-120.216293</td>\n",
       "      <td>NaN</td>\n",
       "      <td>{'bestrating': '5.0', 'ratingvalue': '4.8', 'r...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>None</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>12507827700</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>673463</th>\n",
       "      <td>10002</td>\n",
       "      <td>None</td>\n",
       "      <td>{'postalcode': '79938', 'addresslocality': 'El...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>https://www.ihg.com/destinations/tw/zh/united-...</td>\n",
       "      <td>得克萨斯州</td>\n",
       "      <td>3500 Joe Battle Blvd</td>\n",
       "      <td>美国</td>\n",
       "      <td>None</td>\n",
       "      <td>El Paso</td>\n",
       "      <td>79938</td>\n",
       "      <td>Hotel_ihg.com_September2020.json.gz</td>\n",
       "      <td>1-915-8556161</td>\n",
       "      <td>{'latitude': '3.17972624E1', 'longitude': '-1....</td>\n",
       "      <td>NaN</td>\n",
       "      <td>31.797262</td>\n",
       "      <td>-106.266840</td>\n",
       "      <td>NaN</td>\n",
       "      <td>{'ratingcount': '264', 'bestrating': '5.0', 'r...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>None</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>19158556161</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>673464</th>\n",
       "      <td>10003</td>\n",
       "      <td>None</td>\n",
       "      <td>{'streetaddress': '1091 Doniphan Park Circle',...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>https://www.ihg.com/destinations/tw/zh/united-...</td>\n",
       "      <td>得克萨斯州</td>\n",
       "      <td>1091 Doniphan Park Circle</td>\n",
       "      <td>美国</td>\n",
       "      <td>None</td>\n",
       "      <td>El Paso</td>\n",
       "      <td>79922</td>\n",
       "      <td>Hotel_ihg.com_September2020.json.gz</td>\n",
       "      <td>1-915-5812447</td>\n",
       "      <td>{'latitude': '3.18159774E1', 'longitude': '-1....</td>\n",
       "      <td>NaN</td>\n",
       "      <td>31.815977</td>\n",
       "      <td>-106.556546</td>\n",
       "      <td>NaN</td>\n",
       "      <td>{'bestrating': '5.0', 'ratingvalue': '4.6', 'r...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>None</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>19155812447</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>673465</th>\n",
       "      <td>10004</td>\n",
       "      <td>None</td>\n",
       "      <td>{'postalcode': '76544', 'addresscountry': 'US'...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>https://www.ihg.com/armyhotels/hotels/us/en/fo...</td>\n",
       "      <td>Texas</td>\n",
       "      <td>Bldg 144 761st Tank Battalion</td>\n",
       "      <td>US</td>\n",
       "      <td>None</td>\n",
       "      <td>Ft. Hood</td>\n",
       "      <td>76544</td>\n",
       "      <td>Hotel_ihg.com_September2020.json.gz</td>\n",
       "      <td>1-254-5328233</td>\n",
       "      <td>{'latitude': '31.137222', 'longitude': '-97.76...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>31.137222</td>\n",
       "      <td>-97.760556</td>\n",
       "      <td>NaN</td>\n",
       "      <td>None</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>None</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>12545328233</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 268 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "        row_id  name                                            address  \\\n",
       "673461    9996  None  {'streetaddress': 'Centre Island, Waterways, L...   \n",
       "673462    9999  None  {'streetaddress': '12217 4th Street', 'address...   \n",
       "673463   10002  None  {'postalcode': '79938', 'addresslocality': 'El...   \n",
       "673464   10003  None  {'streetaddress': '1091 Doniphan Park Circle',...   \n",
       "673465   10004  None  {'postalcode': '76544', 'addresscountry': 'US'...   \n",
       "\n",
       "       description pricerange founder owns  \\\n",
       "673461         NaN        NaN     NaN  NaN   \n",
       "673462         NaN        NaN     NaN  NaN   \n",
       "673463         NaN        NaN     NaN  NaN   \n",
       "673464         NaN        NaN     NaN  NaN   \n",
       "673465         NaN        NaN     NaN  NaN   \n",
       "\n",
       "                                                 page_url  \\\n",
       "673461  https://www.ihg.com/hotelindigo/destinations/c...   \n",
       "673462  https://www.ihg.com/holidayinnexpress/destinat...   \n",
       "673463  https://www.ihg.com/destinations/tw/zh/united-...   \n",
       "673464  https://www.ihg.com/destinations/tw/zh/united-...   \n",
       "673465  https://www.ihg.com/armyhotels/hotels/us/en/fo...   \n",
       "\n",
       "               addressregion                                  streetaddress  \\\n",
       "673461                  None  Centre Island, Waterways, Lower Mersey Street   \n",
       "673462  COLOMBIE BRITANNIQUE                               12217 4th Street   \n",
       "673463                 得克萨斯州                           3500 Joe Battle Blvd   \n",
       "673464                 得克萨斯州                      1091 Doniphan Park Circle   \n",
       "673465                 Texas                  Bldg 144 761st Tank Battalion   \n",
       "\n",
       "       addresscountry telephone_address addresslocality postalcode  \\\n",
       "673461             英国              None  Ellesmere Port   CH65 2AL   \n",
       "673462             CA              None    Dawson Creek    V1G 0A4   \n",
       "673463             美国              None         El Paso      79938   \n",
       "673464             美国              None         El Paso      79922   \n",
       "673465             US              None        Ft. Hood      76544   \n",
       "\n",
       "                                     origin       telephone  \\\n",
       "673461  Hotel_ihg.com_September2020.json.gz  44-151-3568111   \n",
       "673462  Hotel_ihg.com_September2020.json.gz   1-250-7827700   \n",
       "673463  Hotel_ihg.com_September2020.json.gz   1-915-8556161   \n",
       "673464  Hotel_ihg.com_September2020.json.gz   1-915-5812447   \n",
       "673465  Hotel_ihg.com_September2020.json.gz   1-254-5328233   \n",
       "\n",
       "                                                      geo sameas   latitude  \\\n",
       "673461  {'longitude': '-2.8944E0', 'latitude': '5.3290...    NaN  53.290300   \n",
       "673462  {'longitude': '-1.20216293E2', 'latitude': '5....    NaN  55.737782   \n",
       "673463  {'latitude': '3.17972624E1', 'longitude': '-1....    NaN  31.797262   \n",
       "673464  {'latitude': '3.18159774E1', 'longitude': '-1....    NaN  31.815977   \n",
       "673465  {'latitude': '31.137222', 'longitude': '-97.76...    NaN  31.137222   \n",
       "\n",
       "         longitude  url                                    aggregaterating  \\\n",
       "673461   -2.894400  NaN  {'bestrating': '5.0', 'ratingvalue': '4.6', 'r...   \n",
       "673462 -120.216293  NaN  {'bestrating': '5.0', 'ratingvalue': '4.8', 'r...   \n",
       "673463 -106.266840  NaN  {'ratingcount': '264', 'bestrating': '5.0', 'r...   \n",
       "673464 -106.556546  NaN  {'bestrating': '5.0', 'ratingvalue': '4.6', 'r...   \n",
       "673465  -97.760556  NaN                                               None   \n",
       "\n",
       "       image openinghours review email contactpoint reviews employees  \\\n",
       "673461   NaN          NaN    NaN  None          NaN     NaN       NaN   \n",
       "673462   NaN          NaN    NaN  None          NaN     NaN       NaN   \n",
       "673463   NaN          NaN    NaN  None          NaN     NaN       NaN   \n",
       "673464   NaN          NaN    NaN  None          NaN     NaN       NaN   \n",
       "673465   NaN          NaN    NaN  None          NaN     NaN       NaN   \n",
       "\n",
       "       faxnumber about citystatezip openinghoursspecification areaserved  \\\n",
       "673461       NaN   NaN          NaN                       NaN        NaN   \n",
       "673462       NaN   NaN          NaN                       NaN        NaN   \n",
       "673463       NaN   NaN          NaN                       NaN        NaN   \n",
       "673464       NaN   NaN          NaN                       NaN        NaN   \n",
       "673465       NaN   NaN          NaN                       NaN        NaN   \n",
       "\n",
       "       location paymentaccepted currenciesaccepted legalname photos photo  \\\n",
       "673461      NaN             NaN                NaN       NaN    NaN   NaN   \n",
       "673462      NaN             NaN                NaN       NaN    NaN   NaN   \n",
       "673463      NaN             NaN                NaN       NaN    NaN   NaN   \n",
       "673464      NaN             NaN                NaN       NaN    NaN   NaN   \n",
       "673465      NaN             NaN                NaN       NaN    NaN   NaN   \n",
       "\n",
       "       logo alternatename brand department makesoffer  map award hasmap  \\\n",
       "673461  NaN           NaN   NaN        NaN        NaN  NaN   NaN    NaN   \n",
       "673462  NaN           NaN   NaN        NaN        NaN  NaN   NaN    NaN   \n",
       "673463  NaN           NaN   NaN        NaN        NaN  NaN   NaN    NaN   \n",
       "673464  NaN           NaN   NaN        NaN        NaN  NaN   NaN    NaN   \n",
       "673465  NaN           NaN   NaN        NaN        NaN  NaN   NaN    NaN   \n",
       "\n",
       "       isicv4 foundingdate  ... haspos availableservice position type  \\\n",
       "673461    NaN          NaN  ...    NaN              NaN      NaN  NaN   \n",
       "673462    NaN          NaN  ...    NaN              NaN      NaN  NaN   \n",
       "673463    NaN          NaN  ...    NaN              NaN      NaN  NaN   \n",
       "673464    NaN          NaN  ...    NaN              NaN      NaN  NaN   \n",
       "673465    NaN          NaN  ...    NaN              NaN      NaN  NaN   \n",
       "\n",
       "       virtualcategory  audience restaurant golfcourse addressname  \\\n",
       "673461             NaN       NaN        NaN        NaN         NaN   \n",
       "673462             NaN       NaN        NaN        NaN         NaN   \n",
       "673463             NaN       NaN        NaN        NaN         NaN   \n",
       "673464             NaN       NaN        NaN        NaN         NaN   \n",
       "673465             NaN       NaN        NaN        NaN         NaN   \n",
       "\n",
       "       receivinghours namecompany provider hascourseinstance serialnumber  \\\n",
       "673461            NaN         NaN      NaN               NaN          NaN   \n",
       "673462            NaN         NaN      NaN               NaN          NaN   \n",
       "673463            NaN         NaN      NaN               NaN          NaN   \n",
       "673464            NaN         NaN      NaN               NaN          NaN   \n",
       "673465            NaN         NaN      NaN               NaN          NaN   \n",
       "\n",
       "       phonenumber \\u201daddresslocality\\u201d  text  target pickupinfo  \\\n",
       "673461         NaN                         NaN   NaN     NaN        NaN   \n",
       "673462         NaN                         NaN   NaN     NaN        NaN   \n",
       "673463         NaN                         NaN   NaN     NaN        NaN   \n",
       "673464         NaN                         NaN   NaN     NaN        NaN   \n",
       "673465         NaN                         NaN   NaN     NaN        NaN   \n",
       "\n",
       "       \\u201daddressregion\\u201d isrelatedto validthrough validfrom menu  \\\n",
       "673461                       NaN         NaN          NaN       NaN  NaN   \n",
       "673462                       NaN         NaN          NaN       NaN  NaN   \n",
       "673463                       NaN         NaN          NaN       NaN  NaN   \n",
       "673464                       NaN         NaN          NaN       NaN  NaN   \n",
       "673465                       NaN         NaN          NaN       NaN  NaN   \n",
       "\n",
       "       rating ingredients haswifi address2 starrating region restaurant-type  \\\n",
       "673461    NaN         NaN     NaN      NaN        NaN    NaN             NaN   \n",
       "673462    NaN         NaN     NaN      NaN        NaN    NaN             NaN   \n",
       "673463    NaN         NaN     NaN      NaN        NaN    NaN             NaN   \n",
       "673464    NaN         NaN     NaN      NaN        NaN    NaN             NaN   \n",
       "673465    NaN         NaN     NaN      NaN        NaN    NaN             NaN   \n",
       "\n",
       "       occasions features checkintime checkouttime  petsallowed subjectof  \\\n",
       "673461       NaN      NaN         NaN          NaN          NaN       NaN   \n",
       "673462       NaN      NaN         NaN          NaN          NaN       NaN   \n",
       "673463       NaN      NaN         NaN          NaN          NaN       NaN   \n",
       "673464       NaN      NaN         NaN          NaN          NaN       NaN   \n",
       "673465       NaN      NaN         NaN          NaN          NaN       NaN   \n",
       "\n",
       "       members hotel-infos-details hotel-infos-adress offeredby  \\\n",
       "673461     NaN                 NaN                NaN       NaN   \n",
       "673462     NaN                 NaN                NaN       NaN   \n",
       "673463     NaN                 NaN                NaN       NaN   \n",
       "673464     NaN                 NaN                NaN       NaN   \n",
       "673465     NaN                 NaN                NaN       NaN   \n",
       "\n",
       "       special_rate_description hotelbrand hotelcode releasedate  \\\n",
       "673461                      NaN        NaN       NaN         NaN   \n",
       "673462                      NaN        NaN       NaN         NaN   \n",
       "673463                      NaN        NaN       NaN         NaN   \n",
       "673464                      NaN        NaN       NaN         NaN   \n",
       "673465                      NaN        NaN       NaN         NaN   \n",
       "\n",
       "       streetlocality streetregion maps occupancy    telephone_  \n",
       "673461            NaN          NaN  NaN       NaN  441513568111  \n",
       "673462            NaN          NaN  NaN       NaN   12507827700  \n",
       "673463            NaN          NaN  NaN       NaN   19158556161  \n",
       "673464            NaN          NaN  NaN       NaN   19155812447  \n",
       "673465            NaN          NaN  NaN       NaN   12545328233  \n",
       "\n",
       "[5 rows x 268 columns]"
      ]
     },
     "execution_count": 32,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_clean = df_clean.drop(columns = [\"level_0\",\"index\"])\n",
    "df_clean.tail()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 33,
   "id": "49acf3d8",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "668088"
      ]
     },
     "execution_count": 33,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "len(df_clean)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "79448668",
   "metadata": {},
   "source": [
    "## Define normalizer for telephone package phonenumbers"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 34,
   "id": "69a2c029",
   "metadata": {},
   "outputs": [],
   "source": [
    "def normalizer(entity):\n",
    "    number = entity[\"telephone_\"]\n",
    "    address_country = entity[\"addresscountry\"]\n",
    "    phone_number = phonenumbers.parse(number, address_country)\n",
    "    return phone_number"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "34348149",
   "metadata": {},
   "source": [
    "## Finally normalizing phone numbers in E.164 format\n",
    "\n",
    "### Ignore those which can not be identified and replace as ``unknown``"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 35,
   "id": "711fdd96",
   "metadata": {
    "scrolled": true
   },
   "outputs": [],
   "source": [
    "df_clean.reset_index(inplace=True)\n",
    "phone_objects =[]\n",
    "#index = []\n",
    "for row_index in df_clean.index:\n",
    "    try:\n",
    "        phone_object =  normalizer(df_clean.iloc[row_index])\n",
    "        #index.append(row_index)\n",
    "        phone_objects.append(phone_object)\n",
    "    except:\n",
    "        phone_objects.append(\"unknown\")\n",
    "    \n",
    "    "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 36,
   "id": "14faafda",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "668088"
      ]
     },
     "execution_count": 36,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "len(phone_objects)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 37,
   "id": "4fe0aae8",
   "metadata": {
    "scrolled": false
   },
   "outputs": [],
   "source": [
    "df_clean[\"phone_object\"] = pd.Series(phone_objects)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 38,
   "id": "babf6e2e",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>row_id</th>\n",
       "      <th>name</th>\n",
       "      <th>address</th>\n",
       "      <th>description</th>\n",
       "      <th>pricerange</th>\n",
       "      <th>founder</th>\n",
       "      <th>owns</th>\n",
       "      <th>page_url</th>\n",
       "      <th>addressregion</th>\n",
       "      <th>streetaddress</th>\n",
       "      <th>addresscountry</th>\n",
       "      <th>telephone_address</th>\n",
       "      <th>addresslocality</th>\n",
       "      <th>postalcode</th>\n",
       "      <th>origin</th>\n",
       "      <th>telephone</th>\n",
       "      <th>geo</th>\n",
       "      <th>sameas</th>\n",
       "      <th>latitude</th>\n",
       "      <th>longitude</th>\n",
       "      <th>url</th>\n",
       "      <th>aggregaterating</th>\n",
       "      <th>image</th>\n",
       "      <th>openinghours</th>\n",
       "      <th>review</th>\n",
       "      <th>email</th>\n",
       "      <th>contactpoint</th>\n",
       "      <th>reviews</th>\n",
       "      <th>employees</th>\n",
       "      <th>faxnumber</th>\n",
       "      <th>about</th>\n",
       "      <th>citystatezip</th>\n",
       "      <th>openinghoursspecification</th>\n",
       "      <th>areaserved</th>\n",
       "      <th>location</th>\n",
       "      <th>paymentaccepted</th>\n",
       "      <th>currenciesaccepted</th>\n",
       "      <th>legalname</th>\n",
       "      <th>photos</th>\n",
       "      <th>photo</th>\n",
       "      <th>logo</th>\n",
       "      <th>alternatename</th>\n",
       "      <th>brand</th>\n",
       "      <th>department</th>\n",
       "      <th>makesoffer</th>\n",
       "      <th>map</th>\n",
       "      <th>award</th>\n",
       "      <th>hasmap</th>\n",
       "      <th>isicv4</th>\n",
       "      <th>foundingdate</th>\n",
       "      <th>...</th>\n",
       "      <th>availableservice</th>\n",
       "      <th>position</th>\n",
       "      <th>type</th>\n",
       "      <th>virtualcategory</th>\n",
       "      <th>audience</th>\n",
       "      <th>restaurant</th>\n",
       "      <th>golfcourse</th>\n",
       "      <th>addressname</th>\n",
       "      <th>receivinghours</th>\n",
       "      <th>namecompany</th>\n",
       "      <th>provider</th>\n",
       "      <th>hascourseinstance</th>\n",
       "      <th>serialnumber</th>\n",
       "      <th>phonenumber</th>\n",
       "      <th>\\u201daddresslocality\\u201d</th>\n",
       "      <th>text</th>\n",
       "      <th>target</th>\n",
       "      <th>pickupinfo</th>\n",
       "      <th>\\u201daddressregion\\u201d</th>\n",
       "      <th>isrelatedto</th>\n",
       "      <th>validthrough</th>\n",
       "      <th>validfrom</th>\n",
       "      <th>menu</th>\n",
       "      <th>rating</th>\n",
       "      <th>ingredients</th>\n",
       "      <th>haswifi</th>\n",
       "      <th>address2</th>\n",
       "      <th>starrating</th>\n",
       "      <th>region</th>\n",
       "      <th>restaurant-type</th>\n",
       "      <th>occasions</th>\n",
       "      <th>features</th>\n",
       "      <th>checkintime</th>\n",
       "      <th>checkouttime</th>\n",
       "      <th>petsallowed</th>\n",
       "      <th>subjectof</th>\n",
       "      <th>members</th>\n",
       "      <th>hotel-infos-details</th>\n",
       "      <th>hotel-infos-adress</th>\n",
       "      <th>offeredby</th>\n",
       "      <th>special_rate_description</th>\n",
       "      <th>hotelbrand</th>\n",
       "      <th>hotelcode</th>\n",
       "      <th>releasedate</th>\n",
       "      <th>streetlocality</th>\n",
       "      <th>streetregion</th>\n",
       "      <th>maps</th>\n",
       "      <th>occupancy</th>\n",
       "      <th>telephone_</th>\n",
       "      <th>phone_object</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1</td>\n",
       "      <td>Galga Studio</td>\n",
       "      <td>{'addresslocality': 'Madrid', 'addresscountry'...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>https://es.litmind.com/galga_studio</td>\n",
       "      <td>Madrid</td>\n",
       "      <td>calle Lorenzo Gonzalez 4</td>\n",
       "      <td>ES</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Madrid</td>\n",
       "      <td>28017</td>\n",
       "      <td>LocalBusiness_litmind.com_September2020.json.gz</td>\n",
       "      <td>+34</td>\n",
       "      <td>{'latitude': '40.4315119', 'longitude': '-3.64...</td>\n",
       "      <td>{'telephone': '+34', 'name': 'Galga Studio'}</td>\n",
       "      <td>40.431512</td>\n",
       "      <td>-3.649591</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>34</td>\n",
       "      <td>Country Code: 34 National Number: 34</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2</td>\n",
       "      <td>Salvador Model Agency</td>\n",
       "      <td>{'postalcode': '28001', 'addresslocality': 'Ma...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>https://es.litmind.com/salvadormodelagency</td>\n",
       "      <td>Madrid</td>\n",
       "      <td>General Pardiñas, 34. 1º7ª</td>\n",
       "      <td>ES</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Madrid</td>\n",
       "      <td>28001</td>\n",
       "      <td>LocalBusiness_litmind.com_September2020.json.gz</td>\n",
       "      <td>+34 914310707</td>\n",
       "      <td>{'longitude': '-3.6835849285126', 'latitude': ...</td>\n",
       "      <td>{'name': 'Salvador Model Agency', 'telephone':...</td>\n",
       "      <td>40.423894</td>\n",
       "      <td>-3.683585</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>34914310707</td>\n",
       "      <td>Country Code: 34 National Number: 914310707</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>10</td>\n",
       "      <td>UNIC AZAFATAS S.L</td>\n",
       "      <td>{'postalcode': '28250', 'addresscountry': 'ES'...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>https://es.litmind.com/456459</td>\n",
       "      <td>Madrid</td>\n",
       "      <td>C/ TORRENCINA 18</td>\n",
       "      <td>ES</td>\n",
       "      <td>NaN</td>\n",
       "      <td>TORRELODONES</td>\n",
       "      <td>28250</td>\n",
       "      <td>LocalBusiness_litmind.com_September2020.json.gz</td>\n",
       "      <td>+34 918599376</td>\n",
       "      <td>{'longitude': '-3.8939949', 'latitude': '40.58...</td>\n",
       "      <td>{'name': 'UNIC AZAFATAS S.L', 'telephone': '+3...</td>\n",
       "      <td>40.580829</td>\n",
       "      <td>-3.893995</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>34918599376</td>\n",
       "      <td>Country Code: 34 National Number: 918599376</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>16</td>\n",
       "      <td>Coconut</td>\n",
       "      <td>{'streetaddress': 'Calle Zabaleta, 10', 'addre...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>https://es.litmind.com/coconutmadrid/info</td>\n",
       "      <td>Madrid</td>\n",
       "      <td>Calle Zabaleta, 10</td>\n",
       "      <td>ES</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Madrid</td>\n",
       "      <td>28002</td>\n",
       "      <td>LocalBusiness_litmind.com_September2020.json.gz</td>\n",
       "      <td>+34 913776214</td>\n",
       "      <td>{'latitude': '40.4413414', 'longitude': '-3.67...</td>\n",
       "      <td>{'name': 'Coconut', 'telephone': '+34 913776214'}</td>\n",
       "      <td>40.441341</td>\n",
       "      <td>-3.674406</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>34913776214</td>\n",
       "      <td>Country Code: 34 National Number: 913776214</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>18</td>\n",
       "      <td>SDA MODEL'S INTERNATIONAL AGENCY</td>\n",
       "      <td>{'postalcode': '28001', 'addresscountry': 'ES'...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>https://es.litmind.com/sdamodelsintagency</td>\n",
       "      <td>Madrid</td>\n",
       "      <td>ayala madrid n7 bajos</td>\n",
       "      <td>ES</td>\n",
       "      <td>NaN</td>\n",
       "      <td>barcelona</td>\n",
       "      <td>28001</td>\n",
       "      <td>LocalBusiness_litmind.com_September2020.json.gz</td>\n",
       "      <td>+34 640847492</td>\n",
       "      <td>{'longitude': '-3.6825650000001', 'latitude': ...</td>\n",
       "      <td>{'name': 'SDA MODEL'S INTERNATIONAL AGENCY', '...</td>\n",
       "      <td>40.427645</td>\n",
       "      <td>-3.682565</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>34640847492</td>\n",
       "      <td>Country Code: 34 National Number: 640847492</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 269 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "   row_id                              name  \\\n",
       "0       1                      Galga Studio   \n",
       "1       2             Salvador Model Agency   \n",
       "2      10                 UNIC AZAFATAS S.L   \n",
       "3      16                           Coconut   \n",
       "4      18  SDA MODEL'S INTERNATIONAL AGENCY   \n",
       "\n",
       "                                             address description pricerange  \\\n",
       "0  {'addresslocality': 'Madrid', 'addresscountry'...         NaN        NaN   \n",
       "1  {'postalcode': '28001', 'addresslocality': 'Ma...         NaN        NaN   \n",
       "2  {'postalcode': '28250', 'addresscountry': 'ES'...         NaN        NaN   \n",
       "3  {'streetaddress': 'Calle Zabaleta, 10', 'addre...         NaN        NaN   \n",
       "4  {'postalcode': '28001', 'addresscountry': 'ES'...         NaN        NaN   \n",
       "\n",
       "  founder owns                                    page_url addressregion  \\\n",
       "0     NaN  NaN         https://es.litmind.com/galga_studio        Madrid   \n",
       "1     NaN  NaN  https://es.litmind.com/salvadormodelagency        Madrid   \n",
       "2     NaN  NaN               https://es.litmind.com/456459        Madrid   \n",
       "3     NaN  NaN   https://es.litmind.com/coconutmadrid/info        Madrid   \n",
       "4     NaN  NaN   https://es.litmind.com/sdamodelsintagency        Madrid   \n",
       "\n",
       "                streetaddress addresscountry telephone_address  \\\n",
       "0    calle Lorenzo Gonzalez 4             ES               NaN   \n",
       "1  General Pardiñas, 34. 1º7ª             ES               NaN   \n",
       "2            C/ TORRENCINA 18             ES               NaN   \n",
       "3          Calle Zabaleta, 10             ES               NaN   \n",
       "4       ayala madrid n7 bajos             ES               NaN   \n",
       "\n",
       "  addresslocality postalcode                                           origin  \\\n",
       "0          Madrid      28017  LocalBusiness_litmind.com_September2020.json.gz   \n",
       "1          Madrid      28001  LocalBusiness_litmind.com_September2020.json.gz   \n",
       "2    TORRELODONES      28250  LocalBusiness_litmind.com_September2020.json.gz   \n",
       "3          Madrid      28002  LocalBusiness_litmind.com_September2020.json.gz   \n",
       "4       barcelona      28001  LocalBusiness_litmind.com_September2020.json.gz   \n",
       "\n",
       "       telephone                                                geo  \\\n",
       "0            +34  {'latitude': '40.4315119', 'longitude': '-3.64...   \n",
       "1  +34 914310707  {'longitude': '-3.6835849285126', 'latitude': ...   \n",
       "2  +34 918599376  {'longitude': '-3.8939949', 'latitude': '40.58...   \n",
       "3  +34 913776214  {'latitude': '40.4413414', 'longitude': '-3.67...   \n",
       "4  +34 640847492  {'longitude': '-3.6825650000001', 'latitude': ...   \n",
       "\n",
       "                                              sameas   latitude  longitude  \\\n",
       "0       {'telephone': '+34', 'name': 'Galga Studio'}  40.431512  -3.649591   \n",
       "1  {'name': 'Salvador Model Agency', 'telephone':...  40.423894  -3.683585   \n",
       "2  {'name': 'UNIC AZAFATAS S.L', 'telephone': '+3...  40.580829  -3.893995   \n",
       "3  {'name': 'Coconut', 'telephone': '+34 913776214'}  40.441341  -3.674406   \n",
       "4  {'name': 'SDA MODEL'S INTERNATIONAL AGENCY', '...  40.427645  -3.682565   \n",
       "\n",
       "   url aggregaterating image openinghours review email contactpoint reviews  \\\n",
       "0  NaN             NaN   NaN          NaN    NaN   NaN          NaN     NaN   \n",
       "1  NaN             NaN   NaN          NaN    NaN   NaN          NaN     NaN   \n",
       "2  NaN             NaN   NaN          NaN    NaN   NaN          NaN     NaN   \n",
       "3  NaN             NaN   NaN          NaN    NaN   NaN          NaN     NaN   \n",
       "4  NaN             NaN   NaN          NaN    NaN   NaN          NaN     NaN   \n",
       "\n",
       "  employees faxnumber about citystatezip openinghoursspecification areaserved  \\\n",
       "0       NaN       NaN   NaN          NaN                       NaN        NaN   \n",
       "1       NaN       NaN   NaN          NaN                       NaN        NaN   \n",
       "2       NaN       NaN   NaN          NaN                       NaN        NaN   \n",
       "3       NaN       NaN   NaN          NaN                       NaN        NaN   \n",
       "4       NaN       NaN   NaN          NaN                       NaN        NaN   \n",
       "\n",
       "  location paymentaccepted currenciesaccepted legalname photos photo logo  \\\n",
       "0      NaN             NaN                NaN       NaN    NaN   NaN  NaN   \n",
       "1      NaN             NaN                NaN       NaN    NaN   NaN  NaN   \n",
       "2      NaN             NaN                NaN       NaN    NaN   NaN  NaN   \n",
       "3      NaN             NaN                NaN       NaN    NaN   NaN  NaN   \n",
       "4      NaN             NaN                NaN       NaN    NaN   NaN  NaN   \n",
       "\n",
       "  alternatename brand department makesoffer  map award hasmap isicv4  \\\n",
       "0           NaN   NaN        NaN        NaN  NaN   NaN    NaN    NaN   \n",
       "1           NaN   NaN        NaN        NaN  NaN   NaN    NaN    NaN   \n",
       "2           NaN   NaN        NaN        NaN  NaN   NaN    NaN    NaN   \n",
       "3           NaN   NaN        NaN        NaN  NaN   NaN    NaN    NaN   \n",
       "4           NaN   NaN        NaN        NaN  NaN   NaN    NaN    NaN   \n",
       "\n",
       "  foundingdate  ... availableservice position type virtualcategory audience  \\\n",
       "0          NaN  ...              NaN      NaN  NaN             NaN      NaN   \n",
       "1          NaN  ...              NaN      NaN  NaN             NaN      NaN   \n",
       "2          NaN  ...              NaN      NaN  NaN             NaN      NaN   \n",
       "3          NaN  ...              NaN      NaN  NaN             NaN      NaN   \n",
       "4          NaN  ...              NaN      NaN  NaN             NaN      NaN   \n",
       "\n",
       "   restaurant golfcourse addressname receivinghours namecompany provider  \\\n",
       "0         NaN        NaN         NaN            NaN         NaN      NaN   \n",
       "1         NaN        NaN         NaN            NaN         NaN      NaN   \n",
       "2         NaN        NaN         NaN            NaN         NaN      NaN   \n",
       "3         NaN        NaN         NaN            NaN         NaN      NaN   \n",
       "4         NaN        NaN         NaN            NaN         NaN      NaN   \n",
       "\n",
       "  hascourseinstance serialnumber phonenumber \\u201daddresslocality\\u201d text  \\\n",
       "0               NaN          NaN         NaN                         NaN  NaN   \n",
       "1               NaN          NaN         NaN                         NaN  NaN   \n",
       "2               NaN          NaN         NaN                         NaN  NaN   \n",
       "3               NaN          NaN         NaN                         NaN  NaN   \n",
       "4               NaN          NaN         NaN                         NaN  NaN   \n",
       "\n",
       "   target  pickupinfo \\u201daddressregion\\u201d isrelatedto validthrough  \\\n",
       "0     NaN         NaN                       NaN         NaN          NaN   \n",
       "1     NaN         NaN                       NaN         NaN          NaN   \n",
       "2     NaN         NaN                       NaN         NaN          NaN   \n",
       "3     NaN         NaN                       NaN         NaN          NaN   \n",
       "4     NaN         NaN                       NaN         NaN          NaN   \n",
       "\n",
       "  validfrom menu rating ingredients haswifi address2 starrating region  \\\n",
       "0       NaN  NaN    NaN         NaN     NaN      NaN        NaN    NaN   \n",
       "1       NaN  NaN    NaN         NaN     NaN      NaN        NaN    NaN   \n",
       "2       NaN  NaN    NaN         NaN     NaN      NaN        NaN    NaN   \n",
       "3       NaN  NaN    NaN         NaN     NaN      NaN        NaN    NaN   \n",
       "4       NaN  NaN    NaN         NaN     NaN      NaN        NaN    NaN   \n",
       "\n",
       "  restaurant-type occasions features checkintime checkouttime petsallowed  \\\n",
       "0             NaN       NaN      NaN         NaN          NaN         NaN   \n",
       "1             NaN       NaN      NaN         NaN          NaN         NaN   \n",
       "2             NaN       NaN      NaN         NaN          NaN         NaN   \n",
       "3             NaN       NaN      NaN         NaN          NaN         NaN   \n",
       "4             NaN       NaN      NaN         NaN          NaN         NaN   \n",
       "\n",
       "   subjectof members hotel-infos-details hotel-infos-adress offeredby  \\\n",
       "0        NaN     NaN                 NaN                NaN       NaN   \n",
       "1        NaN     NaN                 NaN                NaN       NaN   \n",
       "2        NaN     NaN                 NaN                NaN       NaN   \n",
       "3        NaN     NaN                 NaN                NaN       NaN   \n",
       "4        NaN     NaN                 NaN                NaN       NaN   \n",
       "\n",
       "  special_rate_description hotelbrand hotelcode releasedate streetlocality  \\\n",
       "0                      NaN        NaN       NaN         NaN            NaN   \n",
       "1                      NaN        NaN       NaN         NaN            NaN   \n",
       "2                      NaN        NaN       NaN         NaN            NaN   \n",
       "3                      NaN        NaN       NaN         NaN            NaN   \n",
       "4                      NaN        NaN       NaN         NaN            NaN   \n",
       "\n",
       "  streetregion maps occupancy   telephone_  \\\n",
       "0          NaN  NaN       NaN           34   \n",
       "1          NaN  NaN       NaN  34914310707   \n",
       "2          NaN  NaN       NaN  34918599376   \n",
       "3          NaN  NaN       NaN  34913776214   \n",
       "4          NaN  NaN       NaN  34640847492   \n",
       "\n",
       "                                  phone_object  \n",
       "0         Country Code: 34 National Number: 34  \n",
       "1  Country Code: 34 National Number: 914310707  \n",
       "2  Country Code: 34 National Number: 918599376  \n",
       "3  Country Code: 34 National Number: 913776214  \n",
       "4  Country Code: 34 National Number: 640847492  \n",
       "\n",
       "[5 rows x 269 columns]"
      ]
     },
     "execution_count": 38,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_clean = df_clean.drop(columns = \"index\")\n",
    "df_clean.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 39,
   "id": "0da26809",
   "metadata": {},
   "outputs": [],
   "source": [
    "unknown_rows = df_clean[df_clean[\"phone_object\"] == \"unknown\"].index"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 40,
   "id": "31881a1d",
   "metadata": {},
   "outputs": [],
   "source": [
    "df_clean = df_clean.drop(unknown_rows)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 41,
   "id": "ef5cfc81",
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "667297"
      ]
     },
     "execution_count": 41,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "len(df_clean)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "56399561",
   "metadata": {},
   "source": [
    "## Check whether phonenumbers are valid"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 42,
   "id": "6f094ece",
   "metadata": {
    "scrolled": true
   },
   "outputs": [],
   "source": [
    "df_valid_numbers = df_clean[df_clean[\"phone_object\"].apply(phonenumbers.is_valid_number)]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 43,
   "id": "9efdcf5a",
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "613453"
      ]
     },
     "execution_count": 43,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "len(df_valid_numbers)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "13992ba0",
   "metadata": {},
   "source": [
    "## Next step: Format every telephone number into unique E.164 format"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 44,
   "id": "472acd13",
   "metadata": {},
   "outputs": [],
   "source": [
    "#phonenumbers.format_number(df_valid_numbers[\"phone_object\"][0], phonenumbers.PhoneNumberFormat.E164)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 45,
   "id": "4c9c79b8",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "<ipython-input-45-28dce20706cd>:1: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  df_valid_numbers[\"E.164 format\"] = df_valid_numbers[\"phone_object\"].apply(lambda objects: phonenumbers.format_number(objects, phonenumbers.PhoneNumberFormat.E164))\n"
     ]
    }
   ],
   "source": [
    "df_valid_numbers[\"E.164 format\"] = df_valid_numbers[\"phone_object\"].apply(lambda objects: phonenumbers.format_number(objects, phonenumbers.PhoneNumberFormat.E164))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 46,
   "id": "0f4dce86",
   "metadata": {
    "scrolled": false
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "613453"
      ]
     },
     "execution_count": 46,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "len(df_valid_numbers)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 47,
   "id": "ebfa00cd",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>row_id</th>\n",
       "      <th>name</th>\n",
       "      <th>address</th>\n",
       "      <th>description</th>\n",
       "      <th>pricerange</th>\n",
       "      <th>founder</th>\n",
       "      <th>owns</th>\n",
       "      <th>page_url</th>\n",
       "      <th>addressregion</th>\n",
       "      <th>streetaddress</th>\n",
       "      <th>addresscountry</th>\n",
       "      <th>telephone_address</th>\n",
       "      <th>addresslocality</th>\n",
       "      <th>postalcode</th>\n",
       "      <th>origin</th>\n",
       "      <th>telephone</th>\n",
       "      <th>geo</th>\n",
       "      <th>sameas</th>\n",
       "      <th>latitude</th>\n",
       "      <th>longitude</th>\n",
       "      <th>url</th>\n",
       "      <th>aggregaterating</th>\n",
       "      <th>image</th>\n",
       "      <th>openinghours</th>\n",
       "      <th>review</th>\n",
       "      <th>email</th>\n",
       "      <th>contactpoint</th>\n",
       "      <th>reviews</th>\n",
       "      <th>employees</th>\n",
       "      <th>faxnumber</th>\n",
       "      <th>about</th>\n",
       "      <th>citystatezip</th>\n",
       "      <th>openinghoursspecification</th>\n",
       "      <th>areaserved</th>\n",
       "      <th>location</th>\n",
       "      <th>paymentaccepted</th>\n",
       "      <th>currenciesaccepted</th>\n",
       "      <th>legalname</th>\n",
       "      <th>photos</th>\n",
       "      <th>photo</th>\n",
       "      <th>logo</th>\n",
       "      <th>alternatename</th>\n",
       "      <th>brand</th>\n",
       "      <th>department</th>\n",
       "      <th>makesoffer</th>\n",
       "      <th>map</th>\n",
       "      <th>award</th>\n",
       "      <th>hasmap</th>\n",
       "      <th>isicv4</th>\n",
       "      <th>foundingdate</th>\n",
       "      <th>...</th>\n",
       "      <th>position</th>\n",
       "      <th>type</th>\n",
       "      <th>virtualcategory</th>\n",
       "      <th>audience</th>\n",
       "      <th>restaurant</th>\n",
       "      <th>golfcourse</th>\n",
       "      <th>addressname</th>\n",
       "      <th>receivinghours</th>\n",
       "      <th>namecompany</th>\n",
       "      <th>provider</th>\n",
       "      <th>hascourseinstance</th>\n",
       "      <th>serialnumber</th>\n",
       "      <th>phonenumber</th>\n",
       "      <th>\\u201daddresslocality\\u201d</th>\n",
       "      <th>text</th>\n",
       "      <th>target</th>\n",
       "      <th>pickupinfo</th>\n",
       "      <th>\\u201daddressregion\\u201d</th>\n",
       "      <th>isrelatedto</th>\n",
       "      <th>validthrough</th>\n",
       "      <th>validfrom</th>\n",
       "      <th>menu</th>\n",
       "      <th>rating</th>\n",
       "      <th>ingredients</th>\n",
       "      <th>haswifi</th>\n",
       "      <th>address2</th>\n",
       "      <th>starrating</th>\n",
       "      <th>region</th>\n",
       "      <th>restaurant-type</th>\n",
       "      <th>occasions</th>\n",
       "      <th>features</th>\n",
       "      <th>checkintime</th>\n",
       "      <th>checkouttime</th>\n",
       "      <th>petsallowed</th>\n",
       "      <th>subjectof</th>\n",
       "      <th>members</th>\n",
       "      <th>hotel-infos-details</th>\n",
       "      <th>hotel-infos-adress</th>\n",
       "      <th>offeredby</th>\n",
       "      <th>special_rate_description</th>\n",
       "      <th>hotelbrand</th>\n",
       "      <th>hotelcode</th>\n",
       "      <th>releasedate</th>\n",
       "      <th>streetlocality</th>\n",
       "      <th>streetregion</th>\n",
       "      <th>maps</th>\n",
       "      <th>occupancy</th>\n",
       "      <th>telephone_</th>\n",
       "      <th>phone_object</th>\n",
       "      <th>E.164 format</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2</td>\n",
       "      <td>Salvador Model Agency</td>\n",
       "      <td>{'postalcode': '28001', 'addresslocality': 'Ma...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>https://es.litmind.com/salvadormodelagency</td>\n",
       "      <td>Madrid</td>\n",
       "      <td>General Pardiñas, 34. 1º7ª</td>\n",
       "      <td>ES</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Madrid</td>\n",
       "      <td>28001</td>\n",
       "      <td>LocalBusiness_litmind.com_September2020.json.gz</td>\n",
       "      <td>+34 914310707</td>\n",
       "      <td>{'longitude': '-3.6835849285126', 'latitude': ...</td>\n",
       "      <td>{'name': 'Salvador Model Agency', 'telephone':...</td>\n",
       "      <td>40.423894</td>\n",
       "      <td>-3.683585</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>34914310707</td>\n",
       "      <td>Country Code: 34 National Number: 914310707</td>\n",
       "      <td>+34914310707</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>10</td>\n",
       "      <td>UNIC AZAFATAS S.L</td>\n",
       "      <td>{'postalcode': '28250', 'addresscountry': 'ES'...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>https://es.litmind.com/456459</td>\n",
       "      <td>Madrid</td>\n",
       "      <td>C/ TORRENCINA 18</td>\n",
       "      <td>ES</td>\n",
       "      <td>NaN</td>\n",
       "      <td>TORRELODONES</td>\n",
       "      <td>28250</td>\n",
       "      <td>LocalBusiness_litmind.com_September2020.json.gz</td>\n",
       "      <td>+34 918599376</td>\n",
       "      <td>{'longitude': '-3.8939949', 'latitude': '40.58...</td>\n",
       "      <td>{'name': 'UNIC AZAFATAS S.L', 'telephone': '+3...</td>\n",
       "      <td>40.580829</td>\n",
       "      <td>-3.893995</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>34918599376</td>\n",
       "      <td>Country Code: 34 National Number: 918599376</td>\n",
       "      <td>+34918599376</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>16</td>\n",
       "      <td>Coconut</td>\n",
       "      <td>{'streetaddress': 'Calle Zabaleta, 10', 'addre...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>https://es.litmind.com/coconutmadrid/info</td>\n",
       "      <td>Madrid</td>\n",
       "      <td>Calle Zabaleta, 10</td>\n",
       "      <td>ES</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Madrid</td>\n",
       "      <td>28002</td>\n",
       "      <td>LocalBusiness_litmind.com_September2020.json.gz</td>\n",
       "      <td>+34 913776214</td>\n",
       "      <td>{'latitude': '40.4413414', 'longitude': '-3.67...</td>\n",
       "      <td>{'name': 'Coconut', 'telephone': '+34 913776214'}</td>\n",
       "      <td>40.441341</td>\n",
       "      <td>-3.674406</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>34913776214</td>\n",
       "      <td>Country Code: 34 National Number: 913776214</td>\n",
       "      <td>+34913776214</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>18</td>\n",
       "      <td>SDA MODEL'S INTERNATIONAL AGENCY</td>\n",
       "      <td>{'postalcode': '28001', 'addresscountry': 'ES'...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>https://es.litmind.com/sdamodelsintagency</td>\n",
       "      <td>Madrid</td>\n",
       "      <td>ayala madrid n7 bajos</td>\n",
       "      <td>ES</td>\n",
       "      <td>NaN</td>\n",
       "      <td>barcelona</td>\n",
       "      <td>28001</td>\n",
       "      <td>LocalBusiness_litmind.com_September2020.json.gz</td>\n",
       "      <td>+34 640847492</td>\n",
       "      <td>{'longitude': '-3.6825650000001', 'latitude': ...</td>\n",
       "      <td>{'name': 'SDA MODEL'S INTERNATIONAL AGENCY', '...</td>\n",
       "      <td>40.427645</td>\n",
       "      <td>-3.682565</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>34640847492</td>\n",
       "      <td>Country Code: 34 National Number: 640847492</td>\n",
       "      <td>+34640847492</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>20</td>\n",
       "      <td>RAMONSERRANOPHOTO</td>\n",
       "      <td>{'addressregion': 'Badajoz', 'addresslocality'...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>https://es.litmind.com/ramonserranophoto-estudio</td>\n",
       "      <td>Badajoz</td>\n",
       "      <td>Avd. Constitucion, 2</td>\n",
       "      <td>ES</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Villafranca de los Barros</td>\n",
       "      <td>06220</td>\n",
       "      <td>LocalBusiness_litmind.com_September2020.json.gz</td>\n",
       "      <td>+34 636540326</td>\n",
       "      <td>{'longitude': '-6.3428955', 'latitude': '38.56...</td>\n",
       "      <td>{'telephone': '+34 636540326', 'name': 'RAMONS...</td>\n",
       "      <td>38.561655</td>\n",
       "      <td>-6.342896</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>34636540326</td>\n",
       "      <td>Country Code: 34 National Number: 636540326</td>\n",
       "      <td>+34636540326</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 270 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "   row_id                              name  \\\n",
       "1       2             Salvador Model Agency   \n",
       "2      10                 UNIC AZAFATAS S.L   \n",
       "3      16                           Coconut   \n",
       "4      18  SDA MODEL'S INTERNATIONAL AGENCY   \n",
       "5      20                 RAMONSERRANOPHOTO   \n",
       "\n",
       "                                             address description pricerange  \\\n",
       "1  {'postalcode': '28001', 'addresslocality': 'Ma...         NaN        NaN   \n",
       "2  {'postalcode': '28250', 'addresscountry': 'ES'...         NaN        NaN   \n",
       "3  {'streetaddress': 'Calle Zabaleta, 10', 'addre...         NaN        NaN   \n",
       "4  {'postalcode': '28001', 'addresscountry': 'ES'...         NaN        NaN   \n",
       "5  {'addressregion': 'Badajoz', 'addresslocality'...         NaN        NaN   \n",
       "\n",
       "  founder owns                                          page_url  \\\n",
       "1     NaN  NaN        https://es.litmind.com/salvadormodelagency   \n",
       "2     NaN  NaN                     https://es.litmind.com/456459   \n",
       "3     NaN  NaN         https://es.litmind.com/coconutmadrid/info   \n",
       "4     NaN  NaN         https://es.litmind.com/sdamodelsintagency   \n",
       "5     NaN  NaN  https://es.litmind.com/ramonserranophoto-estudio   \n",
       "\n",
       "  addressregion               streetaddress addresscountry telephone_address  \\\n",
       "1        Madrid  General Pardiñas, 34. 1º7ª             ES               NaN   \n",
       "2        Madrid            C/ TORRENCINA 18             ES               NaN   \n",
       "3        Madrid          Calle Zabaleta, 10             ES               NaN   \n",
       "4        Madrid       ayala madrid n7 bajos             ES               NaN   \n",
       "5       Badajoz        Avd. Constitucion, 2             ES               NaN   \n",
       "\n",
       "             addresslocality postalcode  \\\n",
       "1                     Madrid      28001   \n",
       "2               TORRELODONES      28250   \n",
       "3                     Madrid      28002   \n",
       "4                  barcelona      28001   \n",
       "5  Villafranca de los Barros      06220   \n",
       "\n",
       "                                            origin      telephone  \\\n",
       "1  LocalBusiness_litmind.com_September2020.json.gz  +34 914310707   \n",
       "2  LocalBusiness_litmind.com_September2020.json.gz  +34 918599376   \n",
       "3  LocalBusiness_litmind.com_September2020.json.gz  +34 913776214   \n",
       "4  LocalBusiness_litmind.com_September2020.json.gz  +34 640847492   \n",
       "5  LocalBusiness_litmind.com_September2020.json.gz  +34 636540326   \n",
       "\n",
       "                                                 geo  \\\n",
       "1  {'longitude': '-3.6835849285126', 'latitude': ...   \n",
       "2  {'longitude': '-3.8939949', 'latitude': '40.58...   \n",
       "3  {'latitude': '40.4413414', 'longitude': '-3.67...   \n",
       "4  {'longitude': '-3.6825650000001', 'latitude': ...   \n",
       "5  {'longitude': '-6.3428955', 'latitude': '38.56...   \n",
       "\n",
       "                                              sameas   latitude  longitude  \\\n",
       "1  {'name': 'Salvador Model Agency', 'telephone':...  40.423894  -3.683585   \n",
       "2  {'name': 'UNIC AZAFATAS S.L', 'telephone': '+3...  40.580829  -3.893995   \n",
       "3  {'name': 'Coconut', 'telephone': '+34 913776214'}  40.441341  -3.674406   \n",
       "4  {'name': 'SDA MODEL'S INTERNATIONAL AGENCY', '...  40.427645  -3.682565   \n",
       "5  {'telephone': '+34 636540326', 'name': 'RAMONS...  38.561655  -6.342896   \n",
       "\n",
       "   url aggregaterating image openinghours review email contactpoint reviews  \\\n",
       "1  NaN             NaN   NaN          NaN    NaN   NaN          NaN     NaN   \n",
       "2  NaN             NaN   NaN          NaN    NaN   NaN          NaN     NaN   \n",
       "3  NaN             NaN   NaN          NaN    NaN   NaN          NaN     NaN   \n",
       "4  NaN             NaN   NaN          NaN    NaN   NaN          NaN     NaN   \n",
       "5  NaN             NaN   NaN          NaN    NaN   NaN          NaN     NaN   \n",
       "\n",
       "  employees faxnumber about citystatezip openinghoursspecification areaserved  \\\n",
       "1       NaN       NaN   NaN          NaN                       NaN        NaN   \n",
       "2       NaN       NaN   NaN          NaN                       NaN        NaN   \n",
       "3       NaN       NaN   NaN          NaN                       NaN        NaN   \n",
       "4       NaN       NaN   NaN          NaN                       NaN        NaN   \n",
       "5       NaN       NaN   NaN          NaN                       NaN        NaN   \n",
       "\n",
       "  location paymentaccepted currenciesaccepted legalname photos photo logo  \\\n",
       "1      NaN             NaN                NaN       NaN    NaN   NaN  NaN   \n",
       "2      NaN             NaN                NaN       NaN    NaN   NaN  NaN   \n",
       "3      NaN             NaN                NaN       NaN    NaN   NaN  NaN   \n",
       "4      NaN             NaN                NaN       NaN    NaN   NaN  NaN   \n",
       "5      NaN             NaN                NaN       NaN    NaN   NaN  NaN   \n",
       "\n",
       "  alternatename brand department makesoffer  map award hasmap isicv4  \\\n",
       "1           NaN   NaN        NaN        NaN  NaN   NaN    NaN    NaN   \n",
       "2           NaN   NaN        NaN        NaN  NaN   NaN    NaN    NaN   \n",
       "3           NaN   NaN        NaN        NaN  NaN   NaN    NaN    NaN   \n",
       "4           NaN   NaN        NaN        NaN  NaN   NaN    NaN    NaN   \n",
       "5           NaN   NaN        NaN        NaN  NaN   NaN    NaN    NaN   \n",
       "\n",
       "  foundingdate  ... position type virtualcategory audience restaurant  \\\n",
       "1          NaN  ...      NaN  NaN             NaN      NaN        NaN   \n",
       "2          NaN  ...      NaN  NaN             NaN      NaN        NaN   \n",
       "3          NaN  ...      NaN  NaN             NaN      NaN        NaN   \n",
       "4          NaN  ...      NaN  NaN             NaN      NaN        NaN   \n",
       "5          NaN  ...      NaN  NaN             NaN      NaN        NaN   \n",
       "\n",
       "   golfcourse addressname receivinghours namecompany provider  \\\n",
       "1         NaN         NaN            NaN         NaN      NaN   \n",
       "2         NaN         NaN            NaN         NaN      NaN   \n",
       "3         NaN         NaN            NaN         NaN      NaN   \n",
       "4         NaN         NaN            NaN         NaN      NaN   \n",
       "5         NaN         NaN            NaN         NaN      NaN   \n",
       "\n",
       "  hascourseinstance serialnumber phonenumber \\u201daddresslocality\\u201d text  \\\n",
       "1               NaN          NaN         NaN                         NaN  NaN   \n",
       "2               NaN          NaN         NaN                         NaN  NaN   \n",
       "3               NaN          NaN         NaN                         NaN  NaN   \n",
       "4               NaN          NaN         NaN                         NaN  NaN   \n",
       "5               NaN          NaN         NaN                         NaN  NaN   \n",
       "\n",
       "  target  pickupinfo  \\u201daddressregion\\u201d isrelatedto validthrough  \\\n",
       "1    NaN         NaN                        NaN         NaN          NaN   \n",
       "2    NaN         NaN                        NaN         NaN          NaN   \n",
       "3    NaN         NaN                        NaN         NaN          NaN   \n",
       "4    NaN         NaN                        NaN         NaN          NaN   \n",
       "5    NaN         NaN                        NaN         NaN          NaN   \n",
       "\n",
       "  validfrom menu rating ingredients haswifi address2 starrating region  \\\n",
       "1       NaN  NaN    NaN         NaN     NaN      NaN        NaN    NaN   \n",
       "2       NaN  NaN    NaN         NaN     NaN      NaN        NaN    NaN   \n",
       "3       NaN  NaN    NaN         NaN     NaN      NaN        NaN    NaN   \n",
       "4       NaN  NaN    NaN         NaN     NaN      NaN        NaN    NaN   \n",
       "5       NaN  NaN    NaN         NaN     NaN      NaN        NaN    NaN   \n",
       "\n",
       "  restaurant-type occasions features checkintime checkouttime petsallowed  \\\n",
       "1             NaN       NaN      NaN         NaN          NaN         NaN   \n",
       "2             NaN       NaN      NaN         NaN          NaN         NaN   \n",
       "3             NaN       NaN      NaN         NaN          NaN         NaN   \n",
       "4             NaN       NaN      NaN         NaN          NaN         NaN   \n",
       "5             NaN       NaN      NaN         NaN          NaN         NaN   \n",
       "\n",
       "  subjectof  members hotel-infos-details hotel-infos-adress offeredby  \\\n",
       "1       NaN      NaN                 NaN                NaN       NaN   \n",
       "2       NaN      NaN                 NaN                NaN       NaN   \n",
       "3       NaN      NaN                 NaN                NaN       NaN   \n",
       "4       NaN      NaN                 NaN                NaN       NaN   \n",
       "5       NaN      NaN                 NaN                NaN       NaN   \n",
       "\n",
       "  special_rate_description hotelbrand hotelcode releasedate streetlocality  \\\n",
       "1                      NaN        NaN       NaN         NaN            NaN   \n",
       "2                      NaN        NaN       NaN         NaN            NaN   \n",
       "3                      NaN        NaN       NaN         NaN            NaN   \n",
       "4                      NaN        NaN       NaN         NaN            NaN   \n",
       "5                      NaN        NaN       NaN         NaN            NaN   \n",
       "\n",
       "  streetregion maps occupancy   telephone_  \\\n",
       "1          NaN  NaN       NaN  34914310707   \n",
       "2          NaN  NaN       NaN  34918599376   \n",
       "3          NaN  NaN       NaN  34913776214   \n",
       "4          NaN  NaN       NaN  34640847492   \n",
       "5          NaN  NaN       NaN  34636540326   \n",
       "\n",
       "                                  phone_object  E.164 format  \n",
       "1  Country Code: 34 National Number: 914310707  +34914310707  \n",
       "2  Country Code: 34 National Number: 918599376  +34918599376  \n",
       "3  Country Code: 34 National Number: 913776214  +34913776214  \n",
       "4  Country Code: 34 National Number: 640847492  +34640847492  \n",
       "5  Country Code: 34 National Number: 636540326  +34636540326  \n",
       "\n",
       "[5 rows x 270 columns]"
      ]
     },
     "execution_count": 47,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_valid_numbers.head()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "2b4987b2",
   "metadata": {},
   "source": [
    "## After formatting phone numbers into unified format we can group by phone numbers to identify clusters"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 48,
   "id": "ea38a2a7",
   "metadata": {
    "scrolled": false
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "+917042424242      473\n",
       "+908505502060      494\n",
       "+421905383904      516\n",
       "+982144698615      634\n",
       "+566007300073      726\n",
       "+16179368365       757\n",
       "+40364431800       938\n",
       "+18448592146      1032\n",
       "+18552674854      1036\n",
       "+33149461720      1163\n",
       "+18664770844      1278\n",
       "+18775784138      1347\n",
       "+442035985088     1507\n",
       "+443458121007     1701\n",
       "+17136954939      2053\n",
       "+18664773715      2172\n",
       "+917861004444     3577\n",
       "+919313931393     5260\n",
       "+18555161090      6955\n",
       "+18884082399     14917\n",
       "Name: E.164 format, dtype: int64"
      ]
     },
     "execution_count": 48,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_valid_numbers[\"E.164 format\"].value_counts().sort_values().tail(20)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "46a7cfc5",
   "metadata": {},
   "source": [
    "## Adding the matching telephone numbers in a new column"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "09394db4",
   "metadata": {},
   "outputs": [],
   "source": [
    "df_valid_numbers['telephoneNorm'] = df_valid_numbers['E.164 format'].str.replace('+','').astype(np.int64)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 49,
   "id": "e21ec45b",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "<ipython-input-49-623d5e3ddf8f>:11: FutureWarning: The default value of regex will change from True to False in a future version. In addition, single character regular expressions will*not* be treated as literal strings when regex=True.\n",
      "  df_valid_numbers['telephoneNorm'] = df_valid_numbers['E.164 format'].str.replace('+','').astype(np.int64)\n",
      "<ipython-input-49-623d5e3ddf8f>:11: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  df_valid_numbers['telephoneNorm'] = df_valid_numbers['E.164 format'].str.replace('+','').astype(np.int64)\n",
      "<ipython-input-49-623d5e3ddf8f>:13: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  df_valid_numbers['indexValue'] = df_valid_numbers.index\n",
      "<ipython-input-49-623d5e3ddf8f>:24: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  df_valid_numbers['MatchingNumbers'] = df_valid_numbers.apply(lambda row: queryTree(tree,[row['telephoneNorm'], 1]), axis=1)\n"
     ]
    }
   ],
   "source": [
    "# def createKDTree(tupleArray):\n",
    "#     tree = KDTree(tupleArray)\n",
    "#     return tree\n",
    "\n",
    "# # Return all values that are in a specific proximity\n",
    "# def queryTree(tree, point, r = 0):    \n",
    "#     point = [float(i) for i in point]\n",
    "#     idx = tree.query_ball_point(point, r)\n",
    "#     return idx\n",
    "\n",
    "\n",
    "# df_valid_numbers.reset_index(drop=True, inplace=True)\n",
    "# df_valid_numbers['indexValue'] = df_valid_numbers.index\n",
    "# telephoneArray = df_valid_numbers['telephoneNorm'].to_numpy().astype('int64')\n",
    "# fillArray = np.full(len(telephoneArray), 1)\n",
    "# tupleArray = np.array((telephoneArray, fillArray)).T.astype('int64')\n",
    "\n",
    "\n",
    "# # create new column with all matching points\n",
    "# tree = createKDTree(tupleArray)\n",
    "# idx = queryTree(tree, tupleArray[0])\n",
    "\n",
    "# # Search for the closest neighbour in all of the points\n",
    "# df_valid_numbers['MatchingNumbers'] = df_valid_numbers.apply(lambda row: queryTree(tree,[row['telephoneNorm'], 1]), axis=1) "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 50,
   "id": "d81d7a24",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "613453"
      ]
     },
     "execution_count": 50,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# len(df_valid_numbers)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 51,
   "id": "b5bf7265",
   "metadata": {},
   "outputs": [],
   "source": [
    "# # # filter out the values which only have one value\n",
    "# data = df_valid_numbers[df_valid_numbers['MatchingNumbers'].apply(lambda x: len(x) > 1)]"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "ac32b7f2",
   "metadata": {},
   "source": [
    "## Throwing out noisy clusters\n",
    "\n",
    "### Throw out everything > 100 (interim step)\n",
    "### Some peaks come fromt the same table --> could delete those entries right away"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 52,
   "id": "9d8e613f",
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "18884082399     14917\n",
       "18555161090      6955\n",
       "919313931393     5260\n",
       "917861004444     3577\n",
       "18664773715      2172\n",
       "                ...  \n",
       "918045356221        2\n",
       "16053340386         2\n",
       "441992814807        2\n",
       "441276858000        2\n",
       "12159815678         2\n",
       "Name: telephoneNorm, Length: 52050, dtype: int64"
      ]
     },
     "execution_count": 52,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# data[\"telephoneNorm\"].value_counts()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 53,
   "id": "573fd446",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>row_id</th>\n",
       "      <th>name</th>\n",
       "      <th>address</th>\n",
       "      <th>description</th>\n",
       "      <th>pricerange</th>\n",
       "      <th>founder</th>\n",
       "      <th>owns</th>\n",
       "      <th>page_url</th>\n",
       "      <th>addressregion</th>\n",
       "      <th>streetaddress</th>\n",
       "      <th>addresscountry</th>\n",
       "      <th>telephone_address</th>\n",
       "      <th>addresslocality</th>\n",
       "      <th>postalcode</th>\n",
       "      <th>origin</th>\n",
       "      <th>telephone</th>\n",
       "      <th>geo</th>\n",
       "      <th>sameas</th>\n",
       "      <th>latitude</th>\n",
       "      <th>longitude</th>\n",
       "      <th>url</th>\n",
       "      <th>aggregaterating</th>\n",
       "      <th>image</th>\n",
       "      <th>openinghours</th>\n",
       "      <th>review</th>\n",
       "      <th>email</th>\n",
       "      <th>contactpoint</th>\n",
       "      <th>reviews</th>\n",
       "      <th>employees</th>\n",
       "      <th>faxnumber</th>\n",
       "      <th>about</th>\n",
       "      <th>citystatezip</th>\n",
       "      <th>openinghoursspecification</th>\n",
       "      <th>areaserved</th>\n",
       "      <th>location</th>\n",
       "      <th>paymentaccepted</th>\n",
       "      <th>currenciesaccepted</th>\n",
       "      <th>legalname</th>\n",
       "      <th>photos</th>\n",
       "      <th>photo</th>\n",
       "      <th>logo</th>\n",
       "      <th>alternatename</th>\n",
       "      <th>brand</th>\n",
       "      <th>department</th>\n",
       "      <th>makesoffer</th>\n",
       "      <th>map</th>\n",
       "      <th>award</th>\n",
       "      <th>hasmap</th>\n",
       "      <th>isicv4</th>\n",
       "      <th>foundingdate</th>\n",
       "      <th>...</th>\n",
       "      <th>audience</th>\n",
       "      <th>restaurant</th>\n",
       "      <th>golfcourse</th>\n",
       "      <th>addressname</th>\n",
       "      <th>receivinghours</th>\n",
       "      <th>namecompany</th>\n",
       "      <th>provider</th>\n",
       "      <th>hascourseinstance</th>\n",
       "      <th>serialnumber</th>\n",
       "      <th>phonenumber</th>\n",
       "      <th>\\u201daddresslocality\\u201d</th>\n",
       "      <th>text</th>\n",
       "      <th>target</th>\n",
       "      <th>pickupinfo</th>\n",
       "      <th>\\u201daddressregion\\u201d</th>\n",
       "      <th>isrelatedto</th>\n",
       "      <th>validthrough</th>\n",
       "      <th>validfrom</th>\n",
       "      <th>menu</th>\n",
       "      <th>rating</th>\n",
       "      <th>ingredients</th>\n",
       "      <th>haswifi</th>\n",
       "      <th>address2</th>\n",
       "      <th>starrating</th>\n",
       "      <th>region</th>\n",
       "      <th>restaurant-type</th>\n",
       "      <th>occasions</th>\n",
       "      <th>features</th>\n",
       "      <th>checkintime</th>\n",
       "      <th>checkouttime</th>\n",
       "      <th>petsallowed</th>\n",
       "      <th>subjectof</th>\n",
       "      <th>members</th>\n",
       "      <th>hotel-infos-details</th>\n",
       "      <th>hotel-infos-adress</th>\n",
       "      <th>offeredby</th>\n",
       "      <th>special_rate_description</th>\n",
       "      <th>hotelbrand</th>\n",
       "      <th>hotelcode</th>\n",
       "      <th>releasedate</th>\n",
       "      <th>streetlocality</th>\n",
       "      <th>streetregion</th>\n",
       "      <th>maps</th>\n",
       "      <th>occupancy</th>\n",
       "      <th>telephone_</th>\n",
       "      <th>phone_object</th>\n",
       "      <th>E.164 format</th>\n",
       "      <th>telephoneNorm</th>\n",
       "      <th>indexValue</th>\n",
       "      <th>MatchingNumbers</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>2325</th>\n",
       "      <td>0</td>\n",
       "      <td>Local Pest Pros</td>\n",
       "      <td>{'postalcode': '70364', 'addresscountry': 'US'...</td>\n",
       "      <td>Finest Pest Control Houma, LA. We Offer Safe &amp;...</td>\n",
       "      <td>$$-$$$</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>https://www.extreme-directory.net/pest-control...</td>\n",
       "      <td>Louisiana</td>\n",
       "      <td>Valley View Drive</td>\n",
       "      <td>US</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Houma</td>\n",
       "      <td>70364</td>\n",
       "      <td>LocalBusiness_extreme-directory.net_September2...</td>\n",
       "      <td>+1-888-408-2399</td>\n",
       "      <td>{'longitude': '-90.6877', 'latitude': '29.6343'}</td>\n",
       "      <td>NaN</td>\n",
       "      <td>29.6343</td>\n",
       "      <td>-90.6877</td>\n",
       "      <td>{'description': 'Finest Pest Control Houma, LA...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>hello@extreme-directory.net</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>{'closes': '23:59', 'dayofweek': ['Saturday', ...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>18884082399</td>\n",
       "      <td>Country Code: 1 National Number: 8884082399</td>\n",
       "      <td>+18884082399</td>\n",
       "      <td>18884082399</td>\n",
       "      <td>2325</td>\n",
       "      <td>[150046, 248192, 119844, 152549, 119842, 15265...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2326</th>\n",
       "      <td>1</td>\n",
       "      <td>Local Pest Pros</td>\n",
       "      <td>{'addresscountry': 'US', 'addresslocality': 'G...</td>\n",
       "      <td>Finest Pest Control Gulfport, MS. We Offer Saf...</td>\n",
       "      <td>$$-$$$</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>https://www.extreme-directory.net/pest-control...</td>\n",
       "      <td>Mississippi</td>\n",
       "      <td>2nd Avenue</td>\n",
       "      <td>US</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Gulfport</td>\n",
       "      <td>39503</td>\n",
       "      <td>LocalBusiness_extreme-directory.net_September2...</td>\n",
       "      <td>+1-888-408-2399</td>\n",
       "      <td>{'latitude': '30.4776', 'longitude': '-89.1536'}</td>\n",
       "      <td>NaN</td>\n",
       "      <td>30.4776</td>\n",
       "      <td>-89.1536</td>\n",
       "      <td>{'telephone': '+1-888-408-2399', 'name': 'Loca...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>hello@extreme-directory.net</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>{'closes': '23:59', 'dayofweek': ['Saturday', ...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>18884082399</td>\n",
       "      <td>Country Code: 1 National Number: 8884082399</td>\n",
       "      <td>+18884082399</td>\n",
       "      <td>18884082399</td>\n",
       "      <td>2326</td>\n",
       "      <td>[150046, 248192, 119844, 152549, 119842, 15265...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2327</th>\n",
       "      <td>2</td>\n",
       "      <td>Local Pest Pros</td>\n",
       "      <td>{'addressregion': 'California', 'addresscountr...</td>\n",
       "      <td>Finest Pest Control Vista, CA. We Offer Protec...</td>\n",
       "      <td>$$-$$$</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>https://www.extreme-directory.net/pest-control...</td>\n",
       "      <td>California</td>\n",
       "      <td>Primrose Lane</td>\n",
       "      <td>US</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Vista</td>\n",
       "      <td>92084</td>\n",
       "      <td>LocalBusiness_extreme-directory.net_September2...</td>\n",
       "      <td>+1-888-408-2399</td>\n",
       "      <td>{'longitude': '-117.2054', 'latitude': '33.2222'}</td>\n",
       "      <td>NaN</td>\n",
       "      <td>33.2222</td>\n",
       "      <td>-117.2054</td>\n",
       "      <td>{'telephone': '+1-888-408-2399', 'name': 'Loca...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>hello@extreme-directory.net</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>{'closes': '23:59', 'dayofweek': ['Saturday', ...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>18884082399</td>\n",
       "      <td>Country Code: 1 National Number: 8884082399</td>\n",
       "      <td>+18884082399</td>\n",
       "      <td>18884082399</td>\n",
       "      <td>2327</td>\n",
       "      <td>[150046, 248192, 119844, 152549, 119842, 15265...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2328</th>\n",
       "      <td>3</td>\n",
       "      <td>Local Pest Pros</td>\n",
       "      <td>{'addressregion': 'California', 'addresscountr...</td>\n",
       "      <td>Best Pest Control Santa Clara, CA. We Offer Se...</td>\n",
       "      <td>$$-$$$</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>https://www.extreme-directory.net/pest-control...</td>\n",
       "      <td>California</td>\n",
       "      <td>8th Street West</td>\n",
       "      <td>US</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Santa Clara</td>\n",
       "      <td>95051</td>\n",
       "      <td>LocalBusiness_extreme-directory.net_September2...</td>\n",
       "      <td>+1-888-408-2399</td>\n",
       "      <td>{'latitude': '37.3486', 'longitude': '-121.9844'}</td>\n",
       "      <td>NaN</td>\n",
       "      <td>37.3486</td>\n",
       "      <td>-121.9844</td>\n",
       "      <td>{'telephone': '+1-888-408-2399', 'description'...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>hello@extreme-directory.net</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>{'closes': '23:59', 'dayofweek': ['Saturday', ...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>18884082399</td>\n",
       "      <td>Country Code: 1 National Number: 8884082399</td>\n",
       "      <td>+18884082399</td>\n",
       "      <td>18884082399</td>\n",
       "      <td>2328</td>\n",
       "      <td>[150046, 248192, 119844, 152549, 119842, 15265...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2329</th>\n",
       "      <td>4</td>\n",
       "      <td>Local Pest Pros</td>\n",
       "      <td>{'addresscountry': 'US', 'streetaddress': 'Hig...</td>\n",
       "      <td>Finest Pest Control Champaign, IL. We Provide ...</td>\n",
       "      <td>$$-$$$</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>https://www.extreme-directory.net/pest-control...</td>\n",
       "      <td>Illinois</td>\n",
       "      <td>High Street</td>\n",
       "      <td>US</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Champaign</td>\n",
       "      <td>61820</td>\n",
       "      <td>LocalBusiness_extreme-directory.net_September2...</td>\n",
       "      <td>+1-888-408-2399</td>\n",
       "      <td>{'longitude': '-88.2435', 'latitude': '40.1089'}</td>\n",
       "      <td>NaN</td>\n",
       "      <td>40.1089</td>\n",
       "      <td>-88.2435</td>\n",
       "      <td>{'telephone': '+1-888-408-2399', 'name': 'Loca...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>hello@extreme-directory.net</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>{'closes': '23:59', 'dayofweek': ['Saturday', ...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>18884082399</td>\n",
       "      <td>Country Code: 1 National Number: 8884082399</td>\n",
       "      <td>+18884082399</td>\n",
       "      <td>18884082399</td>\n",
       "      <td>2329</td>\n",
       "      <td>[150046, 248192, 119844, 152549, 119842, 15265...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>364107</th>\n",
       "      <td>310</td>\n",
       "      <td>24-Hour Pest Pros</td>\n",
       "      <td>{'addresscountry': 'US', 'addresslocality': 'B...</td>\n",
       "      <td>Best Pest Control Birmingham, AL. We do same d...</td>\n",
       "      <td>$$-$$$</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>https://www.sarahmross.com/tag/24-hour-pest-co...</td>\n",
       "      <td>Alabama</td>\n",
       "      <td>Mulberry Street</td>\n",
       "      <td>US</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Birmingham</td>\n",
       "      <td>35242</td>\n",
       "      <td>LocalBusiness_sarahmross.com_September2020.jso...</td>\n",
       "      <td>+1-888-408-2399</td>\n",
       "      <td>{'latitude': '33.4252', 'longitude': '-86.6714'}</td>\n",
       "      <td>NaN</td>\n",
       "      <td>33.4252</td>\n",
       "      <td>-86.6714</td>\n",
       "      <td>{'telephone': '+1-888-408-2399', 'name': '24-H...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>hello@sarahmross.com</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>{'closes': '23:59', 'dayofweek': ['Saturday', ...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>18884082399</td>\n",
       "      <td>Country Code: 1 National Number: 8884082399</td>\n",
       "      <td>+18884082399</td>\n",
       "      <td>18884082399</td>\n",
       "      <td>364107</td>\n",
       "      <td>[150046, 248192, 119844, 152549, 119842, 15265...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>364108</th>\n",
       "      <td>311</td>\n",
       "      <td>24-Hour Pest Pros</td>\n",
       "      <td>{'addresscountry': 'US', 'postalcode': '60629'...</td>\n",
       "      <td>Top Pest Control Chicago, IL. We do same day s...</td>\n",
       "      <td>$$-$$$</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>https://www.sarahmross.com/pest-control-chicag...</td>\n",
       "      <td>Illinois</td>\n",
       "      <td>Williams Street</td>\n",
       "      <td>US</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Chicago</td>\n",
       "      <td>60629</td>\n",
       "      <td>LocalBusiness_sarahmross.com_September2020.jso...</td>\n",
       "      <td>+1-888-408-2399</td>\n",
       "      <td>{'longitude': '-87.7117', 'latitude': '41.7757'}</td>\n",
       "      <td>NaN</td>\n",
       "      <td>41.7757</td>\n",
       "      <td>-87.7117</td>\n",
       "      <td>{'telephone': '+1-888-408-2399', 'name': '24-H...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>hello@sarahmross.com</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>{'closes': '23:59', 'dayofweek': ['Saturday', ...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>18884082399</td>\n",
       "      <td>Country Code: 1 National Number: 8884082399</td>\n",
       "      <td>+18884082399</td>\n",
       "      <td>18884082399</td>\n",
       "      <td>364108</td>\n",
       "      <td>[150046, 248192, 119844, 152549, 119842, 15265...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>364109</th>\n",
       "      <td>312</td>\n",
       "      <td>24-Hour Pest Pros</td>\n",
       "      <td>{'addresscountry': 'US', 'addresslocality': 'S...</td>\n",
       "      <td>Top Pest Control San Angelo, TX. We do same da...</td>\n",
       "      <td>$$-$$$</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>https://www.sarahmross.com/pest-control-san-an...</td>\n",
       "      <td>Texas</td>\n",
       "      <td>Laurel Lane</td>\n",
       "      <td>US</td>\n",
       "      <td>NaN</td>\n",
       "      <td>San Angelo</td>\n",
       "      <td>76904</td>\n",
       "      <td>LocalBusiness_sarahmross.com_September2020.jso...</td>\n",
       "      <td>+1-888-408-2399</td>\n",
       "      <td>{'latitude': '31.2836', 'longitude': '-100.3945'}</td>\n",
       "      <td>NaN</td>\n",
       "      <td>31.2836</td>\n",
       "      <td>-100.3945</td>\n",
       "      <td>{'telephone': '+1-888-408-2399', 'name': '24-H...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>hello@sarahmross.com</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>{'closes': '23:59', 'dayofweek': ['Saturday', ...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>18884082399</td>\n",
       "      <td>Country Code: 1 National Number: 8884082399</td>\n",
       "      <td>+18884082399</td>\n",
       "      <td>18884082399</td>\n",
       "      <td>364109</td>\n",
       "      <td>[150046, 248192, 119844, 152549, 119842, 15265...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>364110</th>\n",
       "      <td>313</td>\n",
       "      <td>24-Hour Pest Pros</td>\n",
       "      <td>{'addressregion': 'Nevada', 'addresscountry': ...</td>\n",
       "      <td>Top Pest Control North Las Vegas, NV. We do sa...</td>\n",
       "      <td>$$-$$$</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>https://www.sarahmross.com/tag/best-pest-contr...</td>\n",
       "      <td>Nevada</td>\n",
       "      <td>Spring Street</td>\n",
       "      <td>US</td>\n",
       "      <td>NaN</td>\n",
       "      <td>North Las Vegas</td>\n",
       "      <td>89031</td>\n",
       "      <td>LocalBusiness_sarahmross.com_September2020.jso...</td>\n",
       "      <td>+1-888-408-2399</td>\n",
       "      <td>{'longitude': '-115.1717', 'latitude': '36.2589'}</td>\n",
       "      <td>NaN</td>\n",
       "      <td>36.2589</td>\n",
       "      <td>-115.1717</td>\n",
       "      <td>{'telephone': '+1-888-408-2399', 'name': '24-H...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>hello@sarahmross.com</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>{'closes': '23:59', 'dayofweek': ['Saturday', ...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>18884082399</td>\n",
       "      <td>Country Code: 1 National Number: 8884082399</td>\n",
       "      <td>+18884082399</td>\n",
       "      <td>18884082399</td>\n",
       "      <td>364110</td>\n",
       "      <td>[150046, 248192, 119844, 152549, 119842, 15265...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>364111</th>\n",
       "      <td>314</td>\n",
       "      <td>24-Hour Pest Pros</td>\n",
       "      <td>{'addressregion': 'California', 'addresscountr...</td>\n",
       "      <td>Finest Pest Control Corona, CA. We do same day...</td>\n",
       "      <td>$$-$$$</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>https://www.sarahmross.com/tag/24-hour-pest-co...</td>\n",
       "      <td>California</td>\n",
       "      <td>Devon Road</td>\n",
       "      <td>US</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Corona</td>\n",
       "      <td>92882</td>\n",
       "      <td>LocalBusiness_sarahmross.com_September2020.jso...</td>\n",
       "      <td>+1-888-408-2399</td>\n",
       "      <td>{'latitude': '33.8419', 'longitude': '-117.6043'}</td>\n",
       "      <td>NaN</td>\n",
       "      <td>33.8419</td>\n",
       "      <td>-117.6043</td>\n",
       "      <td>{'telephone': '+1-888-408-2399', 'name': '24-H...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>hello@sarahmross.com</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>{'closes': '23:59', 'dayofweek': ['Saturday', ...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>18884082399</td>\n",
       "      <td>Country Code: 1 National Number: 8884082399</td>\n",
       "      <td>+18884082399</td>\n",
       "      <td>18884082399</td>\n",
       "      <td>364111</td>\n",
       "      <td>[150046, 248192, 119844, 152549, 119842, 15265...</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>14917 rows × 273 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "        row_id               name  \\\n",
       "2325         0    Local Pest Pros   \n",
       "2326         1    Local Pest Pros   \n",
       "2327         2    Local Pest Pros   \n",
       "2328         3    Local Pest Pros   \n",
       "2329         4    Local Pest Pros   \n",
       "...        ...                ...   \n",
       "364107     310  24-Hour Pest Pros   \n",
       "364108     311  24-Hour Pest Pros   \n",
       "364109     312  24-Hour Pest Pros   \n",
       "364110     313  24-Hour Pest Pros   \n",
       "364111     314  24-Hour Pest Pros   \n",
       "\n",
       "                                                  address  \\\n",
       "2325    {'postalcode': '70364', 'addresscountry': 'US'...   \n",
       "2326    {'addresscountry': 'US', 'addresslocality': 'G...   \n",
       "2327    {'addressregion': 'California', 'addresscountr...   \n",
       "2328    {'addressregion': 'California', 'addresscountr...   \n",
       "2329    {'addresscountry': 'US', 'streetaddress': 'Hig...   \n",
       "...                                                   ...   \n",
       "364107  {'addresscountry': 'US', 'addresslocality': 'B...   \n",
       "364108  {'addresscountry': 'US', 'postalcode': '60629'...   \n",
       "364109  {'addresscountry': 'US', 'addresslocality': 'S...   \n",
       "364110  {'addressregion': 'Nevada', 'addresscountry': ...   \n",
       "364111  {'addressregion': 'California', 'addresscountr...   \n",
       "\n",
       "                                              description pricerange founder  \\\n",
       "2325    Finest Pest Control Houma, LA. We Offer Safe &...     $$-$$$     NaN   \n",
       "2326    Finest Pest Control Gulfport, MS. We Offer Saf...     $$-$$$     NaN   \n",
       "2327    Finest Pest Control Vista, CA. We Offer Protec...     $$-$$$     NaN   \n",
       "2328    Best Pest Control Santa Clara, CA. We Offer Se...     $$-$$$     NaN   \n",
       "2329    Finest Pest Control Champaign, IL. We Provide ...     $$-$$$     NaN   \n",
       "...                                                   ...        ...     ...   \n",
       "364107  Best Pest Control Birmingham, AL. We do same d...     $$-$$$     NaN   \n",
       "364108  Top Pest Control Chicago, IL. We do same day s...     $$-$$$     NaN   \n",
       "364109  Top Pest Control San Angelo, TX. We do same da...     $$-$$$     NaN   \n",
       "364110  Top Pest Control North Las Vegas, NV. We do sa...     $$-$$$     NaN   \n",
       "364111  Finest Pest Control Corona, CA. We do same day...     $$-$$$     NaN   \n",
       "\n",
       "       owns                                           page_url addressregion  \\\n",
       "2325    NaN  https://www.extreme-directory.net/pest-control...     Louisiana   \n",
       "2326    NaN  https://www.extreme-directory.net/pest-control...   Mississippi   \n",
       "2327    NaN  https://www.extreme-directory.net/pest-control...    California   \n",
       "2328    NaN  https://www.extreme-directory.net/pest-control...    California   \n",
       "2329    NaN  https://www.extreme-directory.net/pest-control...      Illinois   \n",
       "...     ...                                                ...           ...   \n",
       "364107  NaN  https://www.sarahmross.com/tag/24-hour-pest-co...       Alabama   \n",
       "364108  NaN  https://www.sarahmross.com/pest-control-chicag...      Illinois   \n",
       "364109  NaN  https://www.sarahmross.com/pest-control-san-an...         Texas   \n",
       "364110  NaN  https://www.sarahmross.com/tag/best-pest-contr...        Nevada   \n",
       "364111  NaN  https://www.sarahmross.com/tag/24-hour-pest-co...    California   \n",
       "\n",
       "            streetaddress addresscountry telephone_address  addresslocality  \\\n",
       "2325    Valley View Drive             US               NaN            Houma   \n",
       "2326           2nd Avenue             US               NaN         Gulfport   \n",
       "2327        Primrose Lane             US               NaN            Vista   \n",
       "2328      8th Street West             US               NaN      Santa Clara   \n",
       "2329          High Street             US               NaN        Champaign   \n",
       "...                   ...            ...               ...              ...   \n",
       "364107    Mulberry Street             US               NaN       Birmingham   \n",
       "364108    Williams Street             US               NaN          Chicago   \n",
       "364109        Laurel Lane             US               NaN       San Angelo   \n",
       "364110      Spring Street             US               NaN  North Las Vegas   \n",
       "364111         Devon Road             US               NaN           Corona   \n",
       "\n",
       "       postalcode                                             origin  \\\n",
       "2325        70364  LocalBusiness_extreme-directory.net_September2...   \n",
       "2326        39503  LocalBusiness_extreme-directory.net_September2...   \n",
       "2327        92084  LocalBusiness_extreme-directory.net_September2...   \n",
       "2328        95051  LocalBusiness_extreme-directory.net_September2...   \n",
       "2329        61820  LocalBusiness_extreme-directory.net_September2...   \n",
       "...           ...                                                ...   \n",
       "364107      35242  LocalBusiness_sarahmross.com_September2020.jso...   \n",
       "364108      60629  LocalBusiness_sarahmross.com_September2020.jso...   \n",
       "364109      76904  LocalBusiness_sarahmross.com_September2020.jso...   \n",
       "364110      89031  LocalBusiness_sarahmross.com_September2020.jso...   \n",
       "364111      92882  LocalBusiness_sarahmross.com_September2020.jso...   \n",
       "\n",
       "              telephone                                                geo  \\\n",
       "2325    +1-888-408-2399   {'longitude': '-90.6877', 'latitude': '29.6343'}   \n",
       "2326    +1-888-408-2399   {'latitude': '30.4776', 'longitude': '-89.1536'}   \n",
       "2327    +1-888-408-2399  {'longitude': '-117.2054', 'latitude': '33.2222'}   \n",
       "2328    +1-888-408-2399  {'latitude': '37.3486', 'longitude': '-121.9844'}   \n",
       "2329    +1-888-408-2399   {'longitude': '-88.2435', 'latitude': '40.1089'}   \n",
       "...                 ...                                                ...   \n",
       "364107  +1-888-408-2399   {'latitude': '33.4252', 'longitude': '-86.6714'}   \n",
       "364108  +1-888-408-2399   {'longitude': '-87.7117', 'latitude': '41.7757'}   \n",
       "364109  +1-888-408-2399  {'latitude': '31.2836', 'longitude': '-100.3945'}   \n",
       "364110  +1-888-408-2399  {'longitude': '-115.1717', 'latitude': '36.2589'}   \n",
       "364111  +1-888-408-2399  {'latitude': '33.8419', 'longitude': '-117.6043'}   \n",
       "\n",
       "       sameas  latitude  longitude  \\\n",
       "2325      NaN   29.6343   -90.6877   \n",
       "2326      NaN   30.4776   -89.1536   \n",
       "2327      NaN   33.2222  -117.2054   \n",
       "2328      NaN   37.3486  -121.9844   \n",
       "2329      NaN   40.1089   -88.2435   \n",
       "...       ...       ...        ...   \n",
       "364107    NaN   33.4252   -86.6714   \n",
       "364108    NaN   41.7757   -87.7117   \n",
       "364109    NaN   31.2836  -100.3945   \n",
       "364110    NaN   36.2589  -115.1717   \n",
       "364111    NaN   33.8419  -117.6043   \n",
       "\n",
       "                                                      url aggregaterating  \\\n",
       "2325    {'description': 'Finest Pest Control Houma, LA...             NaN   \n",
       "2326    {'telephone': '+1-888-408-2399', 'name': 'Loca...             NaN   \n",
       "2327    {'telephone': '+1-888-408-2399', 'name': 'Loca...             NaN   \n",
       "2328    {'telephone': '+1-888-408-2399', 'description'...             NaN   \n",
       "2329    {'telephone': '+1-888-408-2399', 'name': 'Loca...             NaN   \n",
       "...                                                   ...             ...   \n",
       "364107  {'telephone': '+1-888-408-2399', 'name': '24-H...             NaN   \n",
       "364108  {'telephone': '+1-888-408-2399', 'name': '24-H...             NaN   \n",
       "364109  {'telephone': '+1-888-408-2399', 'name': '24-H...             NaN   \n",
       "364110  {'telephone': '+1-888-408-2399', 'name': '24-H...             NaN   \n",
       "364111  {'telephone': '+1-888-408-2399', 'name': '24-H...             NaN   \n",
       "\n",
       "       image openinghours review                        email contactpoint  \\\n",
       "2325     NaN          NaN    NaN  hello@extreme-directory.net          NaN   \n",
       "2326     NaN          NaN    NaN  hello@extreme-directory.net          NaN   \n",
       "2327     NaN          NaN    NaN  hello@extreme-directory.net          NaN   \n",
       "2328     NaN          NaN    NaN  hello@extreme-directory.net          NaN   \n",
       "2329     NaN          NaN    NaN  hello@extreme-directory.net          NaN   \n",
       "...      ...          ...    ...                          ...          ...   \n",
       "364107   NaN          NaN    NaN         hello@sarahmross.com          NaN   \n",
       "364108   NaN          NaN    NaN         hello@sarahmross.com          NaN   \n",
       "364109   NaN          NaN    NaN         hello@sarahmross.com          NaN   \n",
       "364110   NaN          NaN    NaN         hello@sarahmross.com          NaN   \n",
       "364111   NaN          NaN    NaN         hello@sarahmross.com          NaN   \n",
       "\n",
       "       reviews employees faxnumber about citystatezip  \\\n",
       "2325       NaN       NaN       NaN   NaN          NaN   \n",
       "2326       NaN       NaN       NaN   NaN          NaN   \n",
       "2327       NaN       NaN       NaN   NaN          NaN   \n",
       "2328       NaN       NaN       NaN   NaN          NaN   \n",
       "2329       NaN       NaN       NaN   NaN          NaN   \n",
       "...        ...       ...       ...   ...          ...   \n",
       "364107     NaN       NaN       NaN   NaN          NaN   \n",
       "364108     NaN       NaN       NaN   NaN          NaN   \n",
       "364109     NaN       NaN       NaN   NaN          NaN   \n",
       "364110     NaN       NaN       NaN   NaN          NaN   \n",
       "364111     NaN       NaN       NaN   NaN          NaN   \n",
       "\n",
       "                                openinghoursspecification areaserved location  \\\n",
       "2325    {'closes': '23:59', 'dayofweek': ['Saturday', ...        NaN      NaN   \n",
       "2326    {'closes': '23:59', 'dayofweek': ['Saturday', ...        NaN      NaN   \n",
       "2327    {'closes': '23:59', 'dayofweek': ['Saturday', ...        NaN      NaN   \n",
       "2328    {'closes': '23:59', 'dayofweek': ['Saturday', ...        NaN      NaN   \n",
       "2329    {'closes': '23:59', 'dayofweek': ['Saturday', ...        NaN      NaN   \n",
       "...                                                   ...        ...      ...   \n",
       "364107  {'closes': '23:59', 'dayofweek': ['Saturday', ...        NaN      NaN   \n",
       "364108  {'closes': '23:59', 'dayofweek': ['Saturday', ...        NaN      NaN   \n",
       "364109  {'closes': '23:59', 'dayofweek': ['Saturday', ...        NaN      NaN   \n",
       "364110  {'closes': '23:59', 'dayofweek': ['Saturday', ...        NaN      NaN   \n",
       "364111  {'closes': '23:59', 'dayofweek': ['Saturday', ...        NaN      NaN   \n",
       "\n",
       "       paymentaccepted currenciesaccepted legalname photos photo logo  \\\n",
       "2325               NaN                NaN       NaN    NaN   NaN  NaN   \n",
       "2326               NaN                NaN       NaN    NaN   NaN  NaN   \n",
       "2327               NaN                NaN       NaN    NaN   NaN  NaN   \n",
       "2328               NaN                NaN       NaN    NaN   NaN  NaN   \n",
       "2329               NaN                NaN       NaN    NaN   NaN  NaN   \n",
       "...                ...                ...       ...    ...   ...  ...   \n",
       "364107             NaN                NaN       NaN    NaN   NaN  NaN   \n",
       "364108             NaN                NaN       NaN    NaN   NaN  NaN   \n",
       "364109             NaN                NaN       NaN    NaN   NaN  NaN   \n",
       "364110             NaN                NaN       NaN    NaN   NaN  NaN   \n",
       "364111             NaN                NaN       NaN    NaN   NaN  NaN   \n",
       "\n",
       "       alternatename brand department makesoffer  map award hasmap isicv4  \\\n",
       "2325             NaN   NaN        NaN        NaN  NaN   NaN    NaN    NaN   \n",
       "2326             NaN   NaN        NaN        NaN  NaN   NaN    NaN    NaN   \n",
       "2327             NaN   NaN        NaN        NaN  NaN   NaN    NaN    NaN   \n",
       "2328             NaN   NaN        NaN        NaN  NaN   NaN    NaN    NaN   \n",
       "2329             NaN   NaN        NaN        NaN  NaN   NaN    NaN    NaN   \n",
       "...              ...   ...        ...        ...  ...   ...    ...    ...   \n",
       "364107           NaN   NaN        NaN        NaN  NaN   NaN    NaN    NaN   \n",
       "364108           NaN   NaN        NaN        NaN  NaN   NaN    NaN    NaN   \n",
       "364109           NaN   NaN        NaN        NaN  NaN   NaN    NaN    NaN   \n",
       "364110           NaN   NaN        NaN        NaN  NaN   NaN    NaN    NaN   \n",
       "364111           NaN   NaN        NaN        NaN  NaN   NaN    NaN    NaN   \n",
       "\n",
       "       foundingdate  ... audience restaurant golfcourse addressname  \\\n",
       "2325            NaN  ...      NaN        NaN        NaN         NaN   \n",
       "2326            NaN  ...      NaN        NaN        NaN         NaN   \n",
       "2327            NaN  ...      NaN        NaN        NaN         NaN   \n",
       "2328            NaN  ...      NaN        NaN        NaN         NaN   \n",
       "2329            NaN  ...      NaN        NaN        NaN         NaN   \n",
       "...             ...  ...      ...        ...        ...         ...   \n",
       "364107          NaN  ...      NaN        NaN        NaN         NaN   \n",
       "364108          NaN  ...      NaN        NaN        NaN         NaN   \n",
       "364109          NaN  ...      NaN        NaN        NaN         NaN   \n",
       "364110          NaN  ...      NaN        NaN        NaN         NaN   \n",
       "364111          NaN  ...      NaN        NaN        NaN         NaN   \n",
       "\n",
       "       receivinghours  namecompany provider hascourseinstance serialnumber  \\\n",
       "2325              NaN          NaN      NaN               NaN          NaN   \n",
       "2326              NaN          NaN      NaN               NaN          NaN   \n",
       "2327              NaN          NaN      NaN               NaN          NaN   \n",
       "2328              NaN          NaN      NaN               NaN          NaN   \n",
       "2329              NaN          NaN      NaN               NaN          NaN   \n",
       "...               ...          ...      ...               ...          ...   \n",
       "364107            NaN          NaN      NaN               NaN          NaN   \n",
       "364108            NaN          NaN      NaN               NaN          NaN   \n",
       "364109            NaN          NaN      NaN               NaN          NaN   \n",
       "364110            NaN          NaN      NaN               NaN          NaN   \n",
       "364111            NaN          NaN      NaN               NaN          NaN   \n",
       "\n",
       "       phonenumber \\u201daddresslocality\\u201d text target pickupinfo  \\\n",
       "2325           NaN                         NaN  NaN    NaN        NaN   \n",
       "2326           NaN                         NaN  NaN    NaN        NaN   \n",
       "2327           NaN                         NaN  NaN    NaN        NaN   \n",
       "2328           NaN                         NaN  NaN    NaN        NaN   \n",
       "2329           NaN                         NaN  NaN    NaN        NaN   \n",
       "...            ...                         ...  ...    ...        ...   \n",
       "364107         NaN                         NaN  NaN    NaN        NaN   \n",
       "364108         NaN                         NaN  NaN    NaN        NaN   \n",
       "364109         NaN                         NaN  NaN    NaN        NaN   \n",
       "364110         NaN                         NaN  NaN    NaN        NaN   \n",
       "364111         NaN                         NaN  NaN    NaN        NaN   \n",
       "\n",
       "       \\u201daddressregion\\u201d isrelatedto  validthrough  validfrom menu  \\\n",
       "2325                         NaN         NaN           NaN        NaN  NaN   \n",
       "2326                         NaN         NaN           NaN        NaN  NaN   \n",
       "2327                         NaN         NaN           NaN        NaN  NaN   \n",
       "2328                         NaN         NaN           NaN        NaN  NaN   \n",
       "2329                         NaN         NaN           NaN        NaN  NaN   \n",
       "...                          ...         ...           ...        ...  ...   \n",
       "364107                       NaN         NaN           NaN        NaN  NaN   \n",
       "364108                       NaN         NaN           NaN        NaN  NaN   \n",
       "364109                       NaN         NaN           NaN        NaN  NaN   \n",
       "364110                       NaN         NaN           NaN        NaN  NaN   \n",
       "364111                       NaN         NaN           NaN        NaN  NaN   \n",
       "\n",
       "       rating ingredients haswifi address2 starrating region restaurant-type  \\\n",
       "2325      NaN         NaN     NaN      NaN        NaN    NaN             NaN   \n",
       "2326      NaN         NaN     NaN      NaN        NaN    NaN             NaN   \n",
       "2327      NaN         NaN     NaN      NaN        NaN    NaN             NaN   \n",
       "2328      NaN         NaN     NaN      NaN        NaN    NaN             NaN   \n",
       "2329      NaN         NaN     NaN      NaN        NaN    NaN             NaN   \n",
       "...       ...         ...     ...      ...        ...    ...             ...   \n",
       "364107    NaN         NaN     NaN      NaN        NaN    NaN             NaN   \n",
       "364108    NaN         NaN     NaN      NaN        NaN    NaN             NaN   \n",
       "364109    NaN         NaN     NaN      NaN        NaN    NaN             NaN   \n",
       "364110    NaN         NaN     NaN      NaN        NaN    NaN             NaN   \n",
       "364111    NaN         NaN     NaN      NaN        NaN    NaN             NaN   \n",
       "\n",
       "       occasions features checkintime checkouttime petsallowed subjectof  \\\n",
       "2325         NaN      NaN         NaN          NaN         NaN       NaN   \n",
       "2326         NaN      NaN         NaN          NaN         NaN       NaN   \n",
       "2327         NaN      NaN         NaN          NaN         NaN       NaN   \n",
       "2328         NaN      NaN         NaN          NaN         NaN       NaN   \n",
       "2329         NaN      NaN         NaN          NaN         NaN       NaN   \n",
       "...          ...      ...         ...          ...         ...       ...   \n",
       "364107       NaN      NaN         NaN          NaN         NaN       NaN   \n",
       "364108       NaN      NaN         NaN          NaN         NaN       NaN   \n",
       "364109       NaN      NaN         NaN          NaN         NaN       NaN   \n",
       "364110       NaN      NaN         NaN          NaN         NaN       NaN   \n",
       "364111       NaN      NaN         NaN          NaN         NaN       NaN   \n",
       "\n",
       "       members hotel-infos-details hotel-infos-adress  offeredby  \\\n",
       "2325       NaN                 NaN                NaN        NaN   \n",
       "2326       NaN                 NaN                NaN        NaN   \n",
       "2327       NaN                 NaN                NaN        NaN   \n",
       "2328       NaN                 NaN                NaN        NaN   \n",
       "2329       NaN                 NaN                NaN        NaN   \n",
       "...        ...                 ...                ...        ...   \n",
       "364107     NaN                 NaN                NaN        NaN   \n",
       "364108     NaN                 NaN                NaN        NaN   \n",
       "364109     NaN                 NaN                NaN        NaN   \n",
       "364110     NaN                 NaN                NaN        NaN   \n",
       "364111     NaN                 NaN                NaN        NaN   \n",
       "\n",
       "       special_rate_description hotelbrand hotelcode releasedate  \\\n",
       "2325                        NaN        NaN       NaN         NaN   \n",
       "2326                        NaN        NaN       NaN         NaN   \n",
       "2327                        NaN        NaN       NaN         NaN   \n",
       "2328                        NaN        NaN       NaN         NaN   \n",
       "2329                        NaN        NaN       NaN         NaN   \n",
       "...                         ...        ...       ...         ...   \n",
       "364107                      NaN        NaN       NaN         NaN   \n",
       "364108                      NaN        NaN       NaN         NaN   \n",
       "364109                      NaN        NaN       NaN         NaN   \n",
       "364110                      NaN        NaN       NaN         NaN   \n",
       "364111                      NaN        NaN       NaN         NaN   \n",
       "\n",
       "       streetlocality streetregion maps occupancy   telephone_  \\\n",
       "2325              NaN          NaN  NaN       NaN  18884082399   \n",
       "2326              NaN          NaN  NaN       NaN  18884082399   \n",
       "2327              NaN          NaN  NaN       NaN  18884082399   \n",
       "2328              NaN          NaN  NaN       NaN  18884082399   \n",
       "2329              NaN          NaN  NaN       NaN  18884082399   \n",
       "...               ...          ...  ...       ...          ...   \n",
       "364107            NaN          NaN  NaN       NaN  18884082399   \n",
       "364108            NaN          NaN  NaN       NaN  18884082399   \n",
       "364109            NaN          NaN  NaN       NaN  18884082399   \n",
       "364110            NaN          NaN  NaN       NaN  18884082399   \n",
       "364111            NaN          NaN  NaN       NaN  18884082399   \n",
       "\n",
       "                                       phone_object  E.164 format  \\\n",
       "2325    Country Code: 1 National Number: 8884082399  +18884082399   \n",
       "2326    Country Code: 1 National Number: 8884082399  +18884082399   \n",
       "2327    Country Code: 1 National Number: 8884082399  +18884082399   \n",
       "2328    Country Code: 1 National Number: 8884082399  +18884082399   \n",
       "2329    Country Code: 1 National Number: 8884082399  +18884082399   \n",
       "...                                             ...           ...   \n",
       "364107  Country Code: 1 National Number: 8884082399  +18884082399   \n",
       "364108  Country Code: 1 National Number: 8884082399  +18884082399   \n",
       "364109  Country Code: 1 National Number: 8884082399  +18884082399   \n",
       "364110  Country Code: 1 National Number: 8884082399  +18884082399   \n",
       "364111  Country Code: 1 National Number: 8884082399  +18884082399   \n",
       "\n",
       "       telephoneNorm indexValue  \\\n",
       "2325     18884082399       2325   \n",
       "2326     18884082399       2326   \n",
       "2327     18884082399       2327   \n",
       "2328     18884082399       2328   \n",
       "2329     18884082399       2329   \n",
       "...              ...        ...   \n",
       "364107   18884082399     364107   \n",
       "364108   18884082399     364108   \n",
       "364109   18884082399     364109   \n",
       "364110   18884082399     364110   \n",
       "364111   18884082399     364111   \n",
       "\n",
       "                                          MatchingNumbers  \n",
       "2325    [150046, 248192, 119844, 152549, 119842, 15265...  \n",
       "2326    [150046, 248192, 119844, 152549, 119842, 15265...  \n",
       "2327    [150046, 248192, 119844, 152549, 119842, 15265...  \n",
       "2328    [150046, 248192, 119844, 152549, 119842, 15265...  \n",
       "2329    [150046, 248192, 119844, 152549, 119842, 15265...  \n",
       "...                                                   ...  \n",
       "364107  [150046, 248192, 119844, 152549, 119842, 15265...  \n",
       "364108  [150046, 248192, 119844, 152549, 119842, 15265...  \n",
       "364109  [150046, 248192, 119844, 152549, 119842, 15265...  \n",
       "364110  [150046, 248192, 119844, 152549, 119842, 15265...  \n",
       "364111  [150046, 248192, 119844, 152549, 119842, 15265...  \n",
       "\n",
       "[14917 rows x 273 columns]"
      ]
     },
     "execution_count": 53,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# data.loc[df_valid_numbers[\"telephoneNorm\"] == 18884082399]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 54,
   "id": "d859f588",
   "metadata": {},
   "outputs": [],
   "source": [
    "# len(data)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 55,
   "id": "fc0148dc",
   "metadata": {},
   "outputs": [],
   "source": [
    "# data.head()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "51c64fb3",
   "metadata": {},
   "source": [
    "## Additional Filtering by Geo Location"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 56,
   "id": "afc206ce",
   "metadata": {},
   "outputs": [],
   "source": [
    "# def calcDifference(pointOne, pointTwo):\n",
    "#     return geopy.distance.great_circle(pointOne, pointTwo).km\n",
    "\n",
    "# def calcDifferenceFromRow (row):\n",
    "#     tmp = data\n",
    "#     indexValue = row['indexValue']\n",
    "#     indexPosition = (row[lat], row[lon])\n",
    "#     diffList = []\n",
    "#     for value in row['MatchingGeoPoints']:\n",
    "#         if not value in tmp.index:\n",
    "#             continue\n",
    "#         currRow = data.loc[data['indexValue'] == value]\n",
    "#         currIndex = currRow['indexValue'].values[0]\n",
    "#         if currIndex == indexValue:\n",
    "#             diffList.append(-1)\n",
    "#         else:            \n",
    "#             currPosition = (currRow[lat].values[0], currRow[lon].values[0])\n",
    "#             diffList.append(calcDifference(indexPosition, currPosition))\n",
    "#     return diffList\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "b5b85c07",
   "metadata": {},
   "source": [
    "## Experiment with different radius --> check radius = 0.001 ?"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 57,
   "id": "70c3c18d",
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "<ipython-input-57-8b1e58279b1e>:19: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  data['indexValue'] = data.index\n",
      "<ipython-input-57-8b1e58279b1e>:26: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  data['MatchingGeoPoints'] = data.apply(lambda row: queryTree(tree,[row[lon], row[lat]]), axis=1)\n"
     ]
    }
   ],
   "source": [
    "# def createKDTree(tupleArray):\n",
    "#     tree = KDTree(tupleArray)\n",
    "#     return tree\n",
    "\n",
    "# # Return all values that are in a specific proximity\n",
    "# def queryTree(tree, point, radius = 0.001):    \n",
    "#     point = [float(i) for i in point]\n",
    "#     idx = tree.query_ball_point(point, r=radius)\n",
    "#     return idx\n",
    "#     idx = tree.query(point, k=neighbours)\n",
    "#     return idx[1]\n",
    "\n",
    "# # convert to tuples and from string to float\n",
    "# lonArr = data[lon].to_numpy()\n",
    "# latArr = data[lat].to_numpy()\n",
    "# tupleArray = np.array((lonArr, latArr)).T.astype('float32')\n",
    "\n",
    "# data.reset_index(drop=True, inplace=True)\n",
    "# data['indexValue'] = data.index\n",
    "\n",
    "# # create new column with all matching points\n",
    "# tree = createKDTree(tupleArray)\n",
    "# idx = queryTree(tree, tupleArray[0])\n",
    "\n",
    "# # Search for the closest neighbour in all of the points\n",
    "# data['MatchingGeoPoints'] = data.apply(lambda row: queryTree(tree,[row[lon], row[lat]]), axis=1) \n",
    "\n",
    "# # Keep those that have one or more matches withing the radius\n",
    "# data = data[data['MatchingGeoPoints'].apply(lambda x: len(x) > 1)]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 58,
   "id": "5a6cb2b4",
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "14342959462     1\n",
       "19137834507     1\n",
       "12122812714     1\n",
       "4735081800      1\n",
       "16263868606     1\n",
       "15596217529     1\n",
       "15306003501     1\n",
       "12565120188     1\n",
       "18289636556     1\n",
       "19078315000     1\n",
       "14433241368     1\n",
       "441406373178    1\n",
       "17023673511     1\n",
       "15733351631     1\n",
       "441270610181    1\n",
       "14102893477     1\n",
       "12066218772     1\n",
       "12158626041     1\n",
       "13145618691     1\n",
       "12036563200     1\n",
       "Name: telephoneNorm, dtype: int64"
      ]
     },
     "execution_count": 58,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# data[\"telephoneNorm\"].value_counts().tail(20)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 59,
   "id": "21156e0d",
   "metadata": {},
   "outputs": [],
   "source": [
    "# pd.set_option('max_colwidth', 400)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 60,
   "id": "176cb4d7",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>row_id</th>\n",
       "      <th>name</th>\n",
       "      <th>address</th>\n",
       "      <th>description</th>\n",
       "      <th>pricerange</th>\n",
       "      <th>founder</th>\n",
       "      <th>owns</th>\n",
       "      <th>page_url</th>\n",
       "      <th>addressregion</th>\n",
       "      <th>streetaddress</th>\n",
       "      <th>addresscountry</th>\n",
       "      <th>telephone_address</th>\n",
       "      <th>addresslocality</th>\n",
       "      <th>postalcode</th>\n",
       "      <th>origin</th>\n",
       "      <th>telephone</th>\n",
       "      <th>geo</th>\n",
       "      <th>sameas</th>\n",
       "      <th>latitude</th>\n",
       "      <th>longitude</th>\n",
       "      <th>url</th>\n",
       "      <th>aggregaterating</th>\n",
       "      <th>image</th>\n",
       "      <th>openinghours</th>\n",
       "      <th>review</th>\n",
       "      <th>email</th>\n",
       "      <th>contactpoint</th>\n",
       "      <th>reviews</th>\n",
       "      <th>employees</th>\n",
       "      <th>faxnumber</th>\n",
       "      <th>about</th>\n",
       "      <th>citystatezip</th>\n",
       "      <th>openinghoursspecification</th>\n",
       "      <th>areaserved</th>\n",
       "      <th>location</th>\n",
       "      <th>paymentaccepted</th>\n",
       "      <th>currenciesaccepted</th>\n",
       "      <th>legalname</th>\n",
       "      <th>photos</th>\n",
       "      <th>photo</th>\n",
       "      <th>logo</th>\n",
       "      <th>alternatename</th>\n",
       "      <th>brand</th>\n",
       "      <th>department</th>\n",
       "      <th>makesoffer</th>\n",
       "      <th>map</th>\n",
       "      <th>award</th>\n",
       "      <th>hasmap</th>\n",
       "      <th>isicv4</th>\n",
       "      <th>foundingdate</th>\n",
       "      <th>...</th>\n",
       "      <th>restaurant</th>\n",
       "      <th>golfcourse</th>\n",
       "      <th>addressname</th>\n",
       "      <th>receivinghours</th>\n",
       "      <th>namecompany</th>\n",
       "      <th>provider</th>\n",
       "      <th>hascourseinstance</th>\n",
       "      <th>serialnumber</th>\n",
       "      <th>phonenumber</th>\n",
       "      <th>\\u201daddresslocality\\u201d</th>\n",
       "      <th>text</th>\n",
       "      <th>target</th>\n",
       "      <th>pickupinfo</th>\n",
       "      <th>\\u201daddressregion\\u201d</th>\n",
       "      <th>isrelatedto</th>\n",
       "      <th>validthrough</th>\n",
       "      <th>validfrom</th>\n",
       "      <th>menu</th>\n",
       "      <th>rating</th>\n",
       "      <th>ingredients</th>\n",
       "      <th>haswifi</th>\n",
       "      <th>address2</th>\n",
       "      <th>starrating</th>\n",
       "      <th>region</th>\n",
       "      <th>restaurant-type</th>\n",
       "      <th>occasions</th>\n",
       "      <th>features</th>\n",
       "      <th>checkintime</th>\n",
       "      <th>checkouttime</th>\n",
       "      <th>petsallowed</th>\n",
       "      <th>subjectof</th>\n",
       "      <th>members</th>\n",
       "      <th>hotel-infos-details</th>\n",
       "      <th>hotel-infos-adress</th>\n",
       "      <th>offeredby</th>\n",
       "      <th>special_rate_description</th>\n",
       "      <th>hotelbrand</th>\n",
       "      <th>hotelcode</th>\n",
       "      <th>releasedate</th>\n",
       "      <th>streetlocality</th>\n",
       "      <th>streetregion</th>\n",
       "      <th>maps</th>\n",
       "      <th>occupancy</th>\n",
       "      <th>telephone_</th>\n",
       "      <th>phone_object</th>\n",
       "      <th>E.164 format</th>\n",
       "      <th>telephoneNorm</th>\n",
       "      <th>indexValue</th>\n",
       "      <th>MatchingNumbers</th>\n",
       "      <th>MatchingGeoPoints</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>148556</th>\n",
       "      <td>1</td>\n",
       "      <td>Dilworthtown Inn</td>\n",
       "      <td>{'addressregion': 'PA', 'addresscountry': 'UNITED STATES', 'streetaddress': '1390 Old Wilmington Pike', 'addresslocality': 'West Chester', 'postalcode': '19382'}</td>\n",
       "      <td>The romantic Colonial feeling draws serious foodies from far and wide. This upscale destination in an 18th-century inn serves an American menu led by...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>https://www.visitwilmingtonde.com/listing/dilworthtown-inn/3172/</td>\n",
       "      <td>PA</td>\n",
       "      <td>1390 Old Wilmington Pike</td>\n",
       "      <td>US</td>\n",
       "      <td>NaN</td>\n",
       "      <td>West Chester</td>\n",
       "      <td>19382</td>\n",
       "      <td>Restaurant_visitwilmingtonde.com_September2020.json.gz</td>\n",
       "      <td>(610) 399-1390</td>\n",
       "      <td>{'longitude': '-7.5567815E1', 'latitude': '3.990016E1'}</td>\n",
       "      <td>NaN</td>\n",
       "      <td>39.90016</td>\n",
       "      <td>-75.567815</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>6103991390</td>\n",
       "      <td>Country Code: 1 National Number: 6103991390</td>\n",
       "      <td>+16103991390</td>\n",
       "      <td>16103991390</td>\n",
       "      <td>148556</td>\n",
       "      <td>[456413, 456569]</td>\n",
       "      <td>[148628, 148556]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>148628</th>\n",
       "      <td>167</td>\n",
       "      <td>Dilworthtown Inn</td>\n",
       "      <td>{'addressregion': 'PA', 'addresscountry': 'UNITED STATES', 'streetaddress': '1390 Old Wilmington Pike', 'addresslocality': 'West Chester', 'postalcode': '19382'}</td>\n",
       "      <td>French and Continental cuisine. Incomparable selection of fine wines. Candlelight dining in an Old World atmosphere. Mon.-Sat. 5:30-10:30pm. Sun....</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>https://www.visitwilmingtonde.com/listing/dilworthtown-inn/782/</td>\n",
       "      <td>PA</td>\n",
       "      <td>1390 Old Wilmington Pike</td>\n",
       "      <td>US</td>\n",
       "      <td>NaN</td>\n",
       "      <td>West Chester</td>\n",
       "      <td>19382</td>\n",
       "      <td>Restaurant_visitwilmingtonde.com_September2020.json.gz</td>\n",
       "      <td>(610) 399-1390</td>\n",
       "      <td>{'longitude': '-7.5567815E1', 'latitude': '3.990016E1'}</td>\n",
       "      <td>NaN</td>\n",
       "      <td>39.90016</td>\n",
       "      <td>-75.567815</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>6103991390</td>\n",
       "      <td>Country Code: 1 National Number: 6103991390</td>\n",
       "      <td>+16103991390</td>\n",
       "      <td>16103991390</td>\n",
       "      <td>148628</td>\n",
       "      <td>[456413, 456569]</td>\n",
       "      <td>[148628, 148556]</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>2 rows × 274 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "        row_id              name  \\\n",
       "148556       1  Dilworthtown Inn   \n",
       "148628     167  Dilworthtown Inn   \n",
       "\n",
       "                                                                                                                                                                  address  \\\n",
       "148556  {'addressregion': 'PA', 'addresscountry': 'UNITED STATES', 'streetaddress': '1390 Old Wilmington Pike', 'addresslocality': 'West Chester', 'postalcode': '19382'}   \n",
       "148628  {'addressregion': 'PA', 'addresscountry': 'UNITED STATES', 'streetaddress': '1390 Old Wilmington Pike', 'addresslocality': 'West Chester', 'postalcode': '19382'}   \n",
       "\n",
       "                                                                                                                                                     description  \\\n",
       "148556  The romantic Colonial feeling draws serious foodies from far and wide. This upscale destination in an 18th-century inn serves an American menu led by...   \n",
       "148628      French and Continental cuisine. Incomparable selection of fine wines. Candlelight dining in an Old World atmosphere. Mon.-Sat. 5:30-10:30pm. Sun....   \n",
       "\n",
       "       pricerange founder owns  \\\n",
       "148556        NaN     NaN  NaN   \n",
       "148628        NaN     NaN  NaN   \n",
       "\n",
       "                                                                page_url  \\\n",
       "148556  https://www.visitwilmingtonde.com/listing/dilworthtown-inn/3172/   \n",
       "148628   https://www.visitwilmingtonde.com/listing/dilworthtown-inn/782/   \n",
       "\n",
       "       addressregion             streetaddress addresscountry  \\\n",
       "148556            PA  1390 Old Wilmington Pike             US   \n",
       "148628            PA  1390 Old Wilmington Pike             US   \n",
       "\n",
       "       telephone_address addresslocality postalcode  \\\n",
       "148556               NaN    West Chester      19382   \n",
       "148628               NaN    West Chester      19382   \n",
       "\n",
       "                                                        origin  \\\n",
       "148556  Restaurant_visitwilmingtonde.com_September2020.json.gz   \n",
       "148628  Restaurant_visitwilmingtonde.com_September2020.json.gz   \n",
       "\n",
       "             telephone  \\\n",
       "148556  (610) 399-1390   \n",
       "148628  (610) 399-1390   \n",
       "\n",
       "                                                            geo sameas  \\\n",
       "148556  {'longitude': '-7.5567815E1', 'latitude': '3.990016E1'}    NaN   \n",
       "148628  {'longitude': '-7.5567815E1', 'latitude': '3.990016E1'}    NaN   \n",
       "\n",
       "        latitude  longitude  url aggregaterating image openinghours review  \\\n",
       "148556  39.90016 -75.567815  NaN             NaN   NaN          NaN    NaN   \n",
       "148628  39.90016 -75.567815  NaN             NaN   NaN          NaN    NaN   \n",
       "\n",
       "       email contactpoint reviews employees faxnumber about citystatezip  \\\n",
       "148556   NaN          NaN     NaN       NaN       NaN   NaN          NaN   \n",
       "148628   NaN          NaN     NaN       NaN       NaN   NaN          NaN   \n",
       "\n",
       "       openinghoursspecification areaserved location paymentaccepted  \\\n",
       "148556                       NaN        NaN      NaN             NaN   \n",
       "148628                       NaN        NaN      NaN             NaN   \n",
       "\n",
       "       currenciesaccepted legalname photos photo logo alternatename brand  \\\n",
       "148556                NaN       NaN    NaN   NaN  NaN           NaN   NaN   \n",
       "148628                NaN       NaN    NaN   NaN  NaN           NaN   NaN   \n",
       "\n",
       "       department makesoffer  map award hasmap isicv4 foundingdate  ...  \\\n",
       "148556        NaN        NaN  NaN   NaN    NaN    NaN          NaN  ...   \n",
       "148628        NaN        NaN  NaN   NaN    NaN    NaN          NaN  ...   \n",
       "\n",
       "       restaurant golfcourse addressname receivinghours namecompany  provider  \\\n",
       "148556        NaN        NaN         NaN            NaN         NaN       NaN   \n",
       "148628        NaN        NaN         NaN            NaN         NaN       NaN   \n",
       "\n",
       "       hascourseinstance serialnumber phonenumber \\u201daddresslocality\\u201d  \\\n",
       "148556               NaN          NaN         NaN                         NaN   \n",
       "148628               NaN          NaN         NaN                         NaN   \n",
       "\n",
       "       text target pickupinfo \\u201daddressregion\\u201d isrelatedto  \\\n",
       "148556  NaN    NaN        NaN                       NaN         NaN   \n",
       "148628  NaN    NaN        NaN                       NaN         NaN   \n",
       "\n",
       "       validthrough  validfrom  menu rating ingredients haswifi address2  \\\n",
       "148556          NaN        NaN   NaN    NaN         NaN     NaN      NaN   \n",
       "148628          NaN        NaN   NaN    NaN         NaN     NaN      NaN   \n",
       "\n",
       "       starrating region restaurant-type occasions features checkintime  \\\n",
       "148556        NaN    NaN             NaN       NaN      NaN         NaN   \n",
       "148628        NaN    NaN             NaN       NaN      NaN         NaN   \n",
       "\n",
       "       checkouttime petsallowed subjectof members hotel-infos-details  \\\n",
       "148556          NaN         NaN       NaN     NaN                 NaN   \n",
       "148628          NaN         NaN       NaN     NaN                 NaN   \n",
       "\n",
       "       hotel-infos-adress offeredby  special_rate_description hotelbrand  \\\n",
       "148556                NaN       NaN                       NaN        NaN   \n",
       "148628                NaN       NaN                       NaN        NaN   \n",
       "\n",
       "       hotelcode releasedate streetlocality streetregion maps occupancy  \\\n",
       "148556       NaN         NaN            NaN          NaN  NaN       NaN   \n",
       "148628       NaN         NaN            NaN          NaN  NaN       NaN   \n",
       "\n",
       "        telephone_                                 phone_object  E.164 format  \\\n",
       "148556  6103991390  Country Code: 1 National Number: 6103991390  +16103991390   \n",
       "148628  6103991390  Country Code: 1 National Number: 6103991390  +16103991390   \n",
       "\n",
       "       telephoneNorm indexValue   MatchingNumbers MatchingGeoPoints  \n",
       "148556   16103991390     148556  [456413, 456569]  [148628, 148556]  \n",
       "148628   16103991390     148628  [456413, 456569]  [148628, 148556]  \n",
       "\n",
       "[2 rows x 274 columns]"
      ]
     },
     "execution_count": 60,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# data.loc[data[\"telephoneNorm\"] == 16103991390]"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "b960fc0a",
   "metadata": {},
   "source": [
    "## !Export table with condition and without condition !"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 61,
   "id": "b87fdefd",
   "metadata": {},
   "outputs": [],
   "source": [
    "# data.loc[data['indexValue'] == 5]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 62,
   "id": "f77a2ad4",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Calculate the difference in km between those\n",
    "#data['Difference'] = data.apply(lambda row: calcDifferenceFromRow(row), axis=1) "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 63,
   "id": "ecc13e2d",
   "metadata": {},
   "outputs": [],
   "source": [
    "# data.iloc[3:4]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 64,
   "id": "054db294",
   "metadata": {},
   "outputs": [],
   "source": [
    "# len(data)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 65,
   "id": "4995935c",
   "metadata": {},
   "outputs": [],
   "source": [
    "# data[\"origin\"].value_counts()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 66,
   "id": "b595d143",
   "metadata": {},
   "outputs": [],
   "source": [
    "# data.loc[data['indexValue'] == 32][['name', 'address', 'page_url', 'E.164 format', lat, lon]]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 67,
   "id": "b28783f7",
   "metadata": {},
   "outputs": [],
   "source": [
    "# data.loc[data['indexValue'] == 21907]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 68,
   "id": "9b34c3c5",
   "metadata": {},
   "outputs": [],
   "source": [
    "df_valid_numbers.to_json(\"Concatenated_MatchingFile_with_rest\", compression=\"gzip\", orient='records', lines=True)"
   ]
  }
 ],
 "metadata": {
  "interpreter": {
   "hash": "4e6c05dd04d5f1ab156515bda71d539c3517fd88dab50801005ef579a3eac424"
  },
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.8.8"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
